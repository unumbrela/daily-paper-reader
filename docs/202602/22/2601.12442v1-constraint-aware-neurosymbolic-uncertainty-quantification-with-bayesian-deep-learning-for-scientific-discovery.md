---
title: Constraint-Aware Neurosymbolic Uncertainty Quantification with Bayesian Deep Learning for Scientific Discovery
title_zh: 面向科学发现的基于贝叶斯深度学习的约束感知神经符号不确定性量化
authors: "Shahnawaz Alam, Mohammed Mudassir Uddin, Mohammed Kaif Pasha"
date: 2026-01-18
pdf: "https://arxiv.org/pdf/2601.12442v1"
tags: ["query:sr"]
score: 8.0
evidence: 用于科学发现的神经符号推理
tldr: 针对科学AI中不确定性估计与领域约束结合不足的问题，本文提出CANUF框架。该框架融合了贝叶斯深度学习与可微分符号推理，通过自动约束提取、概率骨干网络及约束满足层，实现了物理一致的概率预测。实验显示其在显著降低校准误差的同时保持了极高的约束满足率，为科学发现提供了可靠且可解释的端到端预测方案。
motivation: 科学AI模型亟需在提供可靠不确定性估计的同时遵循领域物理约束，但现有方法难以兼顾两者。
method: 提出CANUF框架，集成自动约束提取、变分推理概率骨干和可微分约束满足层。
result: "在材料、分子及气候数据集上，校准误差降低了34.7%，且约束满足率高达99.2%。"
conclusion: 该研究实现了首个同时解决不确定性量化、约束满足和可解释性的端到端可微分科学预测流水线。
---

## 摘要
科学人工智能（AI）应用要求模型在遵循领域约束的同时，提供可靠的不确定性估计。现有的不确定性量化方法缺乏整合符号科学知识的机制，而神经符号方法则以确定性方式运行，缺乏原则性的不确定性建模。我们提出了约束感知神经符号不确定性框架（CANUF），将贝叶斯深度学习与可微符号推理相统一。该架构包含三个组件：从科学文献中自动提取约束、具有变分推理的概率神经网络骨干，以及确保物理一致性的可微约束满足层。在 Materials Project（140,000+ 种材料）、QM9 分子性质和气候基准测试上的实验表明，与贝叶斯神经网络相比，CANUF 将预期校准误差（Expected Calibration Error）降低了 34.7%，同时保持了 99.2% 的约束满足率。消融实验表明，约束引导的再校准贡献了 18.3% 的性能提升，约束提取的准确率达到了 91.4%。CANUF 提供了首个端到端可微流水线，同时解决了科学预测中的不确定性量化、约束满足和可解释性说明问题。

## Abstract
Scientific Artificial Intelligence (AI) applications require models that deliver trustworthy uncertainty estimates while respecting domain constraints. Existing uncertainty quantification methods lack mechanisms to incorporate symbolic scientific knowledge, while neurosymbolic approaches operate deterministically without principled uncertainty modeling. We introduce the Constraint-Aware Neurosymbolic Uncertainty Framework (CANUF), unifying Bayesian deep learning with differentiable symbolic reasoning. The architecture comprises three components: automated constraint extraction from scientific literature, probabilistic neural backbone with variational inference, and differentiable constraint satisfaction layer ensuring physical consistency. Experiments on Materials Project (140,000+ materials), QM9 molecular properties, and climate benchmarks show CANUF reduces Expected Calibration Error by 34.7% versus Bayesian neural networks while maintaining 99.2% constraint satisfaction. Ablations reveal constraint-guided recalibration contributes 18.3% performance gain, with constraint extraction achieving 91.4% precision. CANUF provides the first end-to-end differentiable pipeline simultaneously addressing uncertainty quantification, constraint satisfaction, and interpretable explanations for scientific predictions.

---

## 论文详细总结（自动生成）

这篇论文介绍了一个名为 **CANUF**（Constraint-Aware Neurosymbolic Uncertainty Framework）的新型框架，旨在解决科学人工智能（Scientific AI）中预测结果不符合物理规律且不确定性估计不可靠的问题。

以下是对该论文的结构化总结：

### 1. 核心问题与整体含义（研究动机和背景）
在材料科学、气候研究和药物开发等高风险科学领域，深度学习模型虽然表现出色，但存在两个致命缺陷：
*   **物理不一致性**：模型预测的结果可能违反基本的物理定律（如能量守恒、电荷平衡）。
*   **不可靠的不确定性**：现有的概率模型（如贝叶斯神经网络）虽然能给出置信度，但这些置信区间往往不考虑领域约束，导致模型在物理上不可能的区域产生错误的“高置信度”预测。
*   **研究动机**：现有的不确定性量化（UQ）方法缺乏符号知识，而神经符号（Neurosymbolic）方法通常是确定性的。CANUF 的目标是建立一个既能保证约束满足，又能提供校准良好的不确定性估计的统一框架。

### 2. 方法论
CANUF 框架由三个核心组件构成，实现了端到端的可微分流程：
*   **自动约束提取（Automated Constraint Extraction）**：利用预训练的科学语言模型（SciBERT）从文献和数据库中构建知识图谱，通过规则模板匹配（如守恒定律、取值范围）自动发现科学约束，解决了手动编写规则的瓶颈。
*   **贝叶斯神经网络骨干（Bayesian Neural Backbone）**：采用变分推理（Variational Inference）来建模模型参数的后验分布，通过最大化证据下界（ELBO）来捕捉认识不确定性（Epistemic Uncertainty）。
*   **可微分约束满足层（CSL）**：
    *   **投影操作**：将神经网络的原始预测投影到由约束定义的凸可行域内。
    *   **不确定性传播**：利用雅可比矩阵（Jacobian）将预测的不确定性通过投影层进行传播，使得约束不仅修正预测值，也修正置信区间。
    *   **不满足度感知调整**：如果原始预测距离可行域很远，框架会自动增加预测的不确定性，作为模型可能失准的信号。
*   **解释生成器**：当预测被约束层大幅修正时，利用模板生成自然语言解释，告知用户为何进行修正（例如：“为了满足热力学稳定性约束，形成能从 X 调整至 Y”）。

### 3. 实验设计
*   **数据集**：
    1.  **Materials Project**：包含 14.6 万种无机材料，预测形成能，涉及热力学稳定性和电荷中性约束。
    2.  **QM9**：包含 13.3 万个有机分子，预测 HOMO-LUMO 能隙等，涉及价键规则和能量排序约束。
    3.  **CMIP6**：气候模型数据，预测温度和降水，涉及能量和质量守恒约束。
*   **基准方法（Baselines）**：对比了 MC-Dropout、Deep Ensembles、标准 BNN、物理信息神经网络（PINN）、概率代数层（PAL）和 NeuPSL。
*   **评估指标**：RMSE/MAE（准确性）、ECE/NLL（校准质量）、CSR（约束满足率）以及人类专家对解释质量的评分。

### 4. 资源与算力
*   **算力说明**：论文提到了部分实现细节，如使用 4 层全连接网络，隐藏单元为 256。
*   **训练时长**：在 Materials Project 数据集上，CANUF 的训练时间约为 **7.2 小时**，推理延迟为 **21.3 毫秒**。
*   **内存占用**：约 **2.6 GB**。
*   **硬件型号**：文中**未明确说明**具体的 GPU 型号和数量，但从训练时长和内存占用来看，该模型对硬件的要求处于中等水平，普通工作站级 GPU 即可胜任。

### 5. 实验数量与充分性
*   **实验规模**：在三个不同领域的权威大型数据集上进行了测试，样本量均在 5 万至 14 万之间，具有较强的统计说服力。
*   **消融实验**：进行了详细的消融研究，分别验证了约束提取、CSL 层、贝叶斯骨干和校准损失对最终性能的贡献。
*   **鲁棒性测试**：专门设计了分布外（OOD）测试，验证模型在面对未见过的材料类型时的校准能力。
*   **客观性**：实验采用了 5 个随机种子取平均值，并引入了 24 名领域专家进行双盲人类评估，确保了评估的客观性和实际应用价值。

### 6. 主要结论与发现
*   **校准精度大幅提升**：相比标准贝叶斯神经网络，CANUF 将预期校准误差（ECE）平均降低了 **34.7%**。
*   **极高的约束满足率**：在保持高预测精度的同时，实现了 **99.2%** 的硬约束满足率。
*   **OOD 表现优异**：在数据分布发生偏移时，CANUF 能通过约束冲突识别出不确定性，表现出比基准方法更优雅的性能退化。
*   **自动提取有效性**：自动约束提取模块达到了 91.4% 的精确率，能够发现专家手动设定之外的有效规则。

### 7. 优点
*   **理论与实践结合**：不仅给出了工程实现，还通过 PAC-Bayesian 理论解释了约束如何通过缩小假设空间来提升校准度。
*   **端到端可微**：将符号推理嵌入深度学习流程，支持梯度回传，解决了传统神经符号方法难以训练的问题。
*   **可解释性强**：不仅给出“是什么”，还通过自然语言解释“为什么”修正预测，增强了科学家的信任感。

### 8. 不足与局限
*   **计算开销**：由于在推理阶段需要求解二次规划（QP）问题，其推理速度（21.3ms）明显慢于标准神经网络（6-8ms），不适用于超大规模实时推理场景。
*   **约束类型限制**：目前主要处理代数不等式约束，对于涉及复杂时空动力学或偏微分方程（PDE）的约束，仍需进一步扩展。
*   **模板依赖**：约束提取仍依赖于预设的规则模板，对于完全未知的科学规律发现能力有限。

（完）
