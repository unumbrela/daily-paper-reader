---
title: Automated dimensional analysis for PDEs
title_zh: 偏微分方程的自动量纲分析
authors: "Michal Habera, Andreas Zilian"
date: 2026-01-10
pdf: "https://arxiv.org/pdf/2601.06535v1"
tags: ["query:sr"]
score: 7.0
evidence: 用于科学计算的符号量类
tldr: 本研究针对有限元框架缺乏量纲分析支持的问题，提出了一种将物理单位集成到统一形式语言（UFL）中的系统框架。通过将物理维度表示为有理向量空间并利用符号计算，实现了自动化的量纲检查与无量纲化。该方法不仅能作为物理感知的对角预条件子改善线性系统的条件数，还能有效检测浮点舍入误差，为多物理场耦合问题的数值求解提供了稳健的支撑。
motivation: 现有的有限元框架通常缺乏内置的量纲分析支持，导致物理单位的一致性检查和数值稳定性处理变得复杂且易出错。
method: 在UFL中引入符号化的Quantity类，将物理维度映射为有理向量，并利用图遍历模式实现自动化的量纲校验与无量纲化。
result: 实验表明该方法能显著改善纳维-斯托克斯方程的矩阵条件数，并能识别超弹性模型中的浮点抵消误差及简化多物理场耦合参数处理。
conclusion: 该自动化量纲分析框架是一种通用的物理感知预处理技术，可广泛应用于FEniCSx、Firedrake等多种有限元库。
---

## 摘要
物理单位是科学计算的基础。然而，许多有限元框架缺乏对量纲分析的内置支持。在这项工作中，我们提出了一个将物理单位集成到统一形式语言（UFL）中的系统框架。我们实现了一个符号化的 Quantity 类，用于追踪变分形式中的单位。该实现利用了物理量纲的阿贝尔群结构。我们将其表示为 $\mathbb{Q}^n$ 中的向量，以简化运算并提高性能。一种基于图的访问者模式遍历表达式树，以自动执行一致性检查和因式分解。我们证明了这种自动无量纲化可以作为全算子预处理（Full Operator Preconditioning）的最简单形式。它作为一个具有物理感知能力的对角预处理器，在组装前对线性系统进行均衡处理。纳维-斯托克斯方程的数值实验表明，这改善了鞍点矩阵的条件数。对新胡克（Neo-Hooke）超弹性的分析强调了在小变形状态下对浮点消去误差的检测。最后，泊松-恩斯特-普朗克（Poisson--Nernst--Planck）系统示例说明了如何处理带有导出缩放参数的多物理场耦合问题。尽管该实现针对的是 FEniCSx 框架，但其概念具有通用性，可以轻松适配到其他使用 UFL 的有限元库，如 Firedrake 或 DUNE。

## Abstract
Physical units are fundamental to scientific computing. However, many finite element frameworks lack built-in support for dimensional analysis. In this work, we present a systematic framework for integrating physical units into the Unified Form Language (UFL). We implement a symbolic Quantity class to track units within variational forms. The implementation exploits the abelian group structure of physical dimensions. We represent them as vectors in $\mathbb{Q}^n$ to simplify operations and improve performance. A graph-based visitor pattern traverses the expression tree to automate consistency checks and factorization. We demonstrate that this automated nondimensionalization functions as the simplest form of Full Operator Preconditioning. It acts as a physics-aware diagonal preconditioner that equilibrates linear systems prior to assembly. Numerical experiments with the Navier--Stokes equations show that this improves the condition number of the saddle-point matrix. Analysis of Neo-Hooke hyperelasticity highlights the detection of floating-point cancellation errors in small deformation regimes. Finally, the Poisson--Nernst--Planck system example illustrates the handling of coupled multiphysics problems with derived scaling parameters. Although the implementation targets the FEniCSx framework, the concepts are general and easily adaptable to other finite element libraries using UFL, such as Firedrake or DUNE.