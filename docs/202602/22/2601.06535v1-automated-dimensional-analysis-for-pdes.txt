Title: Automated dimensional analysis for PDEs

URL Source: https://arxiv.org/pdf/2601.06535v1

Published Time: Tue, 13 Jan 2026 01:41:02 GMT

Number of Pages: 29

Markdown Content:
# AUTOMATED DIMENSIONAL ANALYSIS FOR PDE S

PREPRINT 

Michal HABERA 

Department of Engineering University of Luxembourg 

michal.habera@uni.lu 

Andreas ZILIAN 

Department of Engineering University of Luxembourg 

andreas.zilian@uni.lu 

January 2026 

# ABSTRACT 

Physical units are fundamental to scientific computing. However, many finite element frameworks lack built-in support for dimensional analysis. In this work, we present a systematic framework for integrating physical units into the Unified Form Language (UFL). We implement a symbolic Quantity class to track units within variational forms. The implementation exploits the abelian group structure of physical dimensions. We represent them as vectors in Qn to simplify operations and improve performance. A graph-based visitor pattern traverses the expression tree to automate consistency checks and factorization. We demonstrate that this automated nondimensionalization functions as the simplest form of Full Operator Preconditioning. It acts as a physics-aware diagonal preconditioner that equilibrates linear systems prior to assembly. Numerical experiments with the Navier–Stokes equations show that this improves the condition number of the saddle-point matrix. Analysis of Neo-Hooke hyperelasticity highlights the detection of floating-point cancellation errors in small deformation regimes. Finally, the Poisson–Nernst–Planck system example illustrates the handling of coupled multiphysics problems with derived scaling parameters. Although the implementation targets the FEniCSx framework, the concepts are general and easily adaptable to other finite element libraries using UFL, such as Firedrake or DUNE. 

Keywords Dimensional analysis · Physical units · Unified Form Language · Full Operator Preconditioning · Finite Element Method · Multiphysics 

# 1 Introduction 

Physical units are fundamental to scientific computing, yet many numerical libraries lack built-in support for dimensional analysis and unit consistency checking. This deficiency is particularly acute in the field of Finite Element Method (FEM) for the solution of partial differential equations (PDEs), where complex multiphysics models often involve quantities spanning many orders of magnitude and diverse physical dimensions. The importance of robust unit handling in scientific and engineering software cannot be overstated, as demonstrated by historical failures such as NASA’s Mars Climate Orbiter disaster in 1999 (Mars Climate Orbiter Mishap Investigation Board, 1999). The mission’s 125 million dollar spacecraft was lost when it entered the Martian atmosphere at an incorrect angle due to a units mismatch. Ground software produced output in pound-force-seconds, while the spacecraft navigation system expected newton-seconds. This costly error highlights why strong type checking and dimensional analysis should be fundamental aspects of scientific computing frameworks. For more examples of failures and accidents caused by mistakes in physical units, see Pusz (2019). Our framework addresses this gap by providing a systematic approach to handle units in modeling based on the Unified Form Language (UFL). It enables automatic nondimensionalization, dimensional consistency verification, and facilitates the application of the Buckingham Pi theorem for identifying dimensionless groups in physical systems directly from the variational formulation. 

> arXiv:2601.06535v1 [cs.MS] 10 Jan 2026

Automated dimensional analysis for PDEs PREPRINT 

1.1 Existing libraries for physical units 

Several software packages have attempted to address the problem of unit handling in scientific computing. Pint (Grecco et al., 2023) is a Python package for handling physical quantities with units, providing arithmetic operations and unit conversions. The Boost.Units C++ template library (Schabel and Watanabe, 2008) implements compile-time dimensional analysis. For Julia, there are Unitful.jl (Keller et al., 2022) and DynamicQuantities.jl (Cranmer et al., 2023). Julia is a very promising language for unit analysis given its just-in-time (JIT) compilation and dynamic type deduction. For Python alone, other packages worth mentioning are Astropy.units (Astropy Collaboration, Robitaille, Tollerud, et al., 2013), Natu (Davies, 2013), Buckingham (Mdipierro, 2016), Magnitude (Reyero, 2006), and Python-quantities (Dale, 2009). SymPy (Meurer, Smith, Paprocki, et al., 2017) provides a comprehensive units module that combines symbolic mathematics with dimensional analysis capabilities, allowing for algebraic manipulation of expressions containing physical quantities with units. Despite this capability, it is primarily designed for symbolic mathematics rather than numerical computation or finite element assembly. Recent efforts in the C++ community include the comprehensive proposal P1935R0 (Pusz, 2019), “A C++ Approach to Physical Units”, which aims to standardize physical units support for C++. This proposal introduces a compile-time dimensional analysis system with quantity types, powerful unit conversions, and user-defined units. It enables operations such as: 

static_assert(10km / 2 == 5km); // numeric operations 

static_assert(1h == 3600s); // unit conversions 

static_assert(1km / 1s == 1000mps); // dimension conversions 

Additional tools are reviewed in Langtangen and Pedersen (2016, §1.1), which provides a comprehensive treatment of scaling and nondimensionalization techniques for differential equations. However, the above-mentioned packages primarily focus on standalone calculations rather than integration with PDE solvers. In this work, we focus on PDEs and systems of PDEs as the governing equations for multiphysics problems. 

# 2 Brief mathematical background 

2.1 Definitions 

Quantity (or physical quantity ) is a property of a physical system that can be numerically measured (directly or indirectly). Examples of physical quantities are width, weight, event duration, viscosity, velocity, etc. 

Dimension (or physical dimension ) of a quantity describes what kind of quantity it is. It expresses our abstract understanding of the nature of the quantity. In fact, the number of base physical dimensions depends on what type of quantities we want to describe and what we know about them. Examples of physical dimensions are length, mass, time, electric current, etc. 

Unit (or physical unit ) is a specific, agreed-upon scale used to measure a physical quantity. Examples of physical units are meter, kilogram, second, ampere, pound, hour, foot, etc. 

2.2 Dimensional analysis principles 

Dimensions of physical quantities can be expressed as products of powers of base dimensions. For a quantity q, we can write 

[q] = NaIbLcJdMeΘf Tg , (1) where N, I, L, J, M, Θ, and T represent the seven base dimensions of the International System of Units (SI) for amount of substance, electric current, length, luminous intensity, mass, temperature, and time, respectively, see International Organization for Standardization (2022). The operator [·] denotes the dimension of the respective quantity. It is crucial to distinguish between dimensions and units when discussing dimensional analysis. A dimension represents a physical quantity’s nature (e.g., length, time, mass), while a unit is a specific scale used to measure that dimension (e.g., meters, hours, tons). Two quantities can have the same dimension but different units. 2Automated dimensional analysis for PDEs PREPRINT 

Table 1: Overview of SI units showing the seven base units and common derived units with their dimension vectors. 

Category Physical quantity Unit Dimension vector N I L J M Θ T

Base units Amount of substance mole (mol) 1 0 0 0 0 0 0Electric current ampere (A) 0 1 0 0 0 0 0Length meter (m) 0 0 1 0 0 0 0Luminous intensity candela (cd) 0 0 0 1 0 0 0Mass kilogram (kg) 0 0 0 0 1 0 0Temperature kelvin (K) 0 0 0 0 0 1 0Time second (s) 0 0 0 0 0 0 1Derived units Velocity m/s 0 0 1 0 0 0 -1 Acceleration m/s 2 0 0 1 0 0 0 -2 Force newton (N) 0 0 1 0 1 0 -2 Energy/Work joule (J) 0 0 2 0 1 0 -2 Power watt (W) 0 0 2 0 1 0 -3 Pressure pascal (Pa) 0 0 -1 0 1 0 -2 Frequency hertz (Hz) 0 0 0 0 0 0 -1 Electric charge coulomb (C) 0 1 0 0 0 0 1Voltage volt (V) 0 -1 2 0 1 0 -3 Resistance ohm ( Ω) 0 -2 2 0 1 0 -3 Mathematically, the set of dimensions forms a free abelian (commutative) group under multiplication, which can be represented as a vector space over the field of rational numbers. 1 Each physical dimension can be expressed in a chosen base system as a vector in Qd. For the SI system, we have d = 7 base dimensions, so the dimension of a quantity q can be represented as some d(q) = ( a, b, c, d, e, f, g )T ∈ Q7, where the components represent the exponents of the seven SI base dimensions mentioned earlier. For instance 

[velocity ] = LT −1, d(velocity ) = (0 , 0, 1, 0, 0, 0, −1) T,

[force ] = MLT −2, d(force ) = (0 , 0, 1, 0, 1, 0, −2) T,

[energy ] = ML 2T−2, d(energy ) = (0 , 0, 2, 0, 1, 0, −2) T.

(2) Operations on physical quantities correspond to operations in this vector space: • multiplication of quantities: [q1 · q2] = [ q1] · [q2] corresponds to dimensional vector addition 

d(q1 · q2) = d(q1) + d(q2),

• division of quantities: [q1/q 2] = [ q1]/[q2] corresponds to dimensional vector subtraction 

d(q1/q 2) = d(q1) − d(q2),

• powers of quantities: [qn] = [ q]n corresponds to dimensional scalar multiplication 

d(qn) = n · d(q)

for n ∈ Q.Dimensionless quantities (pure numbers) correspond to the identity element in this vector space, which is a vector with all components equal to zero: 

d(dimensionless ) = (0 , 0, 0, 0, 0, 0, 0) T. (3) Two physical quantities can be added or compared only if they have the same dimension vector. This is the mathematical foundation of the requirement for dimensional homogeneity in physical equations. 

> 1The mathematical structure can be formalized further, see Tao (2012), but for the purposes of practical implementation we focus on the vector space representation.

3Automated dimensional analysis for PDEs PREPRINT 

2.3 Buckingham Pi Theorem 

The Buckingham Pi theorem (Buckingham, 1914) provides a rigorous mathematical foundation for dimensional analysis. Consider a physical system described by n physical quantities {q1, q 2, . . . , q n} involving k physical dimensions. Let 

M ∈ Qk×n be the dimensional matrix, where each element Mij represents the exponent of the i-th base dimension in quantity qj . The dimension of quantity qj can be expressed as 

[qj ] = 

> k

Y

> i=1

[Di]Mij (4) where [Di] represents the i-th base dimension. Or, equivalently, the j-th column of M corresponds to the dimension vector d(qj ) of quantity qj :

M =



| | |

d(q1) d(q2) . . . d(qn)

| | |

 . (5) 

Theorem 1 (Buckingham Pi) Let a physical system be described by a relation F (q1, q 2, . . . , q n) = 0 involving n

physical quantities that depend on k base dimensions. Then the system can be equivalently described by some 

G(Π 1, Π2, . . . , Πp) = 0 , where ker( M) = span {d(Π 1), d(Π 2), . . . , d(Π p)}. The p = dim(ker( M)) independent dimensionless quantities are called dimensionless groups and they form the basis for the kernel of the dimensional matrix M.

Alternative formulations of the Buckingham Pi theorem state that p = n − rank( M). This is valid under the assumption that all n quantities are functionally independent. The dimensionless groups {Π1, Π2, . . . , Πp}, also called Π-groups, correspond to the kernel of the matrix M. If {α1, α2, . . . , αp} forms a basis for ker( M), then each dimensionless group Πj can be expressed as 

Πj =

> n

Y

> i=1

qαji  

> i

(6) where αji is the i-th component of vector αj .We need to stress at this point that dimensionless groups are not unique. Any function of dimensionless groups is also dimensionless. Therefore, the choice of basis for ker( M) is not unique and different choices lead to different sets of dimensionless groups. However, all choices are equivalent in the sense that they span the same space of dimensionless quantities. The non-uniqueness of dimensionless groups could be eliminated by additional constraints. This is explored in later sections where we discuss nondimensionalization of specific PDEs. 

Example (Flow around a sphere). We include a simple example that illustrates the application of the Buckingham Pi theorem. Consider the drag force FD on a sphere of diameter D moving through a fluid with velocity v, density ρ, and dynamic viscosity μ. The relevant quantities are {FD , D, v, ρ, μ } with dimensions 

[FD ] = LMT −2, [D] = L, [v] = LT −1,

[ρ] = L−3M, [μ] = L−1MT −1. (7) The dimensional matrix for this system is 

M =



0 0 0 0 00 0 0 0 01 1 1 −3 −10 0 0 0 01 0 0 1 10 0 0 0 0

−2 0 −1 0 −1



(8) where the rows correspond to the dimensions N, I, L, J, M, Θ and T, and the columns correspond to the quantities FD ,

D, v, ρ, and μ, respectively. Since rank( M) = 3 and there are n = 5 quantities, the Buckingham Pi theorem establishes p = n − rank( M) = 2 

dimensionless groups. Computing a basis for the nullspace of M yields 

ker( M) = span 

n 1, −2, −2, 1, 0T ,  0, 1, 1, 0, −1To

, (9) 4Automated dimensional analysis for PDEs PREPRINT 

which corresponds to the dimensionless groups 

Π1 = FD

ρv 2D2 (drag coefficient, CD ),

Π2 = ρvD μ (Reynolds number, Re) .

(10) This formulation has profound implications for modeling physical systems: it reduces the number of parameters needed to describe the system and reveals the fundamental scaling relationships between variables. Any physically meaningful equation must be expressible in terms of these dimensionless groups, providing a powerful indication of insightful forms of governing equations and facilitating both experimental design and numerical simulation. 

# 3 Implementation in a domain specific language for PDEs 

In this section, we present the main theoretical concepts and their implementation for handling physical units and dimensional analysis within PDE contexts. We focus on the Unified Form Language (UFL) (Alnæs et al., 2014), which is widely used for defining variational forms in finite element frameworks, see the next section for a brief overview. The implementation is part of the Dolfiny package (Zilian and Habera, 2021), which provides a set of extensions and utilities for the FEniCSx (Baratta et al., 2023) finite element framework. However, it is easy to adapt the concepts to other finite element frameworks that use UFL as their form language, such as Firedrake (Ham et al., 2023) or DUNE (Sander, 2020). The framework introduces a Quantity class to represent physical quantities with associated units. The core of the framework is based on three main components: 1. Transformation . A visitor pattern that traverses UFL expression trees to inject unit information and reference scales into the expressions. 2. Factorization . A mechanism to extract and manipulate unit factors from expressions, enabling dimensional consistency checks and simplifications. 3. Normalization . A procedure to derive dimensionless forms of variational forms by selecting a reference factor and dividing through the entire expression. In the following subsections, we explain the Unified Form Language, the Quantity class, and the three main compo-nents of our framework in more detail. 

3.1 The Unified Form Language 

The Unified Form Language (UFL) (Alnæs et al., 2014) is a domain-specific language for declaring finite element variational forms and functionals in a notation resembling mathematical syntax. It serves as the front-end for finite element frameworks like FEniCSx (Baratta et al., 2023), Firedrake (Ham et al., 2023) and DUNE (Sander, 2020), enabling users to express PDEs in a form that closely mimics their mathematical representation while remaining computer-interpretable. UFL represents mathematical expressions as Directed Acyclic Graphs (DAG), where each node corresponds to an operation or a terminal object. These expressions can include spatial differential operators (gradient, divergence, curl, etc.), geometric quantities (normal vectors, mesh coordinates, Jacobian matrix of a transformation, etc.), and algebraic operations (addition, multiplication, division, etc.). 

Example (Poisson equation in UFL). To represent the weak form of the Poisson equation 

−∆u = f, (11) one would write the abstract variational formulation: find u ∈ U such that 

a(u, δu ) = L(δu ) ∀δu ∈ U, a(u, δu ) = 

Z

> Ω

∇u · ∇ δu dx, L(δu ) = 

Z

> Ω

f δu dx, (12) where U is an appropriate function space, δu ∈ U is a test function, and Ω ⊂ Rd is the problem domain. In UFL, this translates to the code shown in Fig. 1. 5Automated dimensional analysis for PDEs PREPRINT         

> 1u = ufl.TrialFunction(U)
> 2δu = ufl.TestFunction(U)
> 3a = ufl.inner(ufl.grad(u), ufl.grad( δu)) * ufl.dx
> 4L = ufl.inner(f, δu) * ufl.dx

Figure 1: Implementation of the Poisson equation weak form in the Unified Form Language (UFL). UFL provides a rich type system for representing different mathematical objects, including functions, vectors, tensors, and differential operators. It also includes a symbolic differentiation system that can automatically compute symbolic and functional derivatives, which is essential for implementing nonlinear solvers and adjoint-based optimization. Its expression tree structure is particularly suitable for our unit transformation approach, as it allows systematic traversal and manipulation of mathematical expressions. We leverage UFL’s MultiFunction visitor pattern to implement dimensional analysis and unit transformations while preserving the mathematical structure of expressions. 

3.2 Quantity class 

We define a Quantity class that extends ufl.Constant with unit information. The ufl.Constant represents a value that is constant over the domain. Each Quantity stores a symbolic representation (based on sympy.Symbol ) alongside its physical unit using SymPy’s physical units module. These quantities serve as reference scales for dimensional analysis and unit tracking. The advantage of using SymPy’s unit system is that it already implements a comprehensive set of physical units, including SI base units, derived units, and support for unit conversions. This allows us to leverage SymPy’s capabilities for unit arithmetic and conversions within our framework. 

Example (Quantities with units for the Poisson equation). The following example demonstrates an implementation of the Poisson equation (12) when used as a model for electric potential distribution u. A reference electric potential, 

uref , which has dimensions [uref ] = I−1L2M1T−3 takes a specific value uref = 1 V when expressed based on the derived unit volt, as shown in Fig. 2. On the right-hand side of the equation, we have a source term f with dimensions 

[f ] = I−1M1T−3, represented by the reference quantity fref = 1 V m −2. The characteristic length scale of the domain is represented by lref = 1 m with dimensions [lref ] = L.        

> 1import sympy.physics.units as syu
> 2from sympy import Symbol
> 3from dolfiny.units import Quantity
> 4# ...
> 5u_ref = Quantity(mesh, 1.0, syu.volt, "u_ref")
> 6f_ref = Quantity(mesh, 1.0, syu.volt * syu.meter ** (-2), "f_ref")
> 7l_ref = Quantity(mesh, 1.0, syu.meter, "l_ref")

Figure 2: Example of defining reference quantities with physical units using the Quantity class. As a bonus, SymPy’s unit system allows the definition of quantities using derived units and metric prefixes, so we can equivalently define uref = 1000 mV , etc. 

3.3 Transformation 

All UFL expressions are dimensionless: their DAG nodes carry no unit information, so unit consistency checks and dimensional analysis are not possible. To introduce physical units and dimensions, we traverse the DAG with a 

UnitTransformer that replaces selected nodes by scaled expressions including Quantity objects. Each symbol or operator follows a transformation rule. Some operators (e.g. the spatial gradient ∇) have built-in rules depending on the characteristic length of the mesh, lref . The transformation step injects explicit scaling factors into the expression DAG to account for the reference quantities. A special rule is required to transform integrals. For an integral over a domain Ω ⊂ Rd or a boundary Γ ⊂ Rd−1 we apply Z

> Ω

dx 7 → ld

> ref

Z

> Ω

dx, 

Z

> Γ

ds 7 → ld−1ref 

Z

> Γ

ds (13) 6Automated dimensional analysis for PDEs PREPRINT 

where d is the topological dimension of the domain. This scaling accounts for the change of units in the measure of integration. It is important to note that UFL does not have a built-in support for time derivatives, so time derivative operators are not handled in the current implementation of the UnitTransformer . The user is expected to discretize the time derivatives manually, so the insertion of the reference time scale must be done by the user as well. Integration with automated time discretization frameworks built on top of UFL, such as Irksome (Farrell, Kirby, and Marchena-Menendez, 2020), is a topic for future work. 

Example (Transforming the Poisson equation). For the Poisson example, the transformation reads 

u 7 → uref u, f 7 → fref f, δu 7 → uref δu, ∇ 7 → 1

lref 

∇. (14) Here, uref , f ref , and lref are Quantity objects carrying the reference units for the electric potential, source term, and length scale, respectively. Figure 3 illustrates this process for the integrand of the bilinear form in the Poisson problem, ∇u · ∇ δu . In the original DAG (Fig. 3a), the two gradient nodes Grad feed directly into the inner product node Inner . In the transformed DAG (Fig. 3b), each gradient is first divided by the length reference lref (to nondimensionalize the derivative) and then multiplied by the field reference uref . The blue-shaded nodes denote the inserted Quantity factors, while the white nodes show the original UFL operators. Nodes labeled Division and Product were introduced by the transformer. Inner 

Grad 

u

Grad 

δu 

> (a) Original DAG: no unit factors present.

Inner 

Division 

Grad 

Product 

uref u

lref 

Division 

Grad 

Product 

uref δu 

lref     

> (b) Transformed DAG: each gradient is rescaled by l−1ref and terminal nodes with uref .

Figure 3: Comparison of the UFL expression DAG before and after inserting quantity scaling factors. Blue nodes show the added Quantity objects and their effect on the computation graph. 

3.4 Factorization 

The main idea in checking dimensional consistency and dimensional analysis lies in the Quantity factorization step. In this step, a DAG traversal class called QuantityFactorizer applies homogeneous factorization of selected UFL expressions. Recall that a function f : V → W is called positively homogeneous of degree k ∈ R, if 

f (αv ) = αkf (v) (15) holds for all α ∈ R, α > 0 and all v ∈ V . Homogeneous factorization is a transformation that factors the αk from the DAG and explicitly represents the factor αk for each selected UFL expression. The factorization is executed in a visitor pattern that traverses the DAG in a post-order manner (child nodes before parents). Internally, the factors for each DAG node store a vector d ∈ Qn, where n is the number of Quantity objects provided to the factorizer. The vector represents homogeneous dependence of the respective node with respect to the list of Quantity objects provided to the factorizer. 7Automated dimensional analysis for PDEs PREPRINT 

Special handling and checks are required for the sum operator. Consider a weighted sum 

f (v) = α g (v) + β h (v) (16) which is nonhomogeneous in v. We define two types of inconsistencies that can arise during the factorization of the sum: 1. Inconsistent factors : α̸ = β, and, as a special case, 2. Inconsistent dimensions : [α]̸ = [ β].When either of these inconsistencies are detected, the factorization process raises an exception. The two types of inconsistencies have different implications that need to be treated differently. 

Inconsistent factors indicate a mismatch in the scales and magnitudes of the summands. This could have implications for the numerical conditioning or numerical stability of the problem, and ideally a transformation that equilibrates all scales in the sum is required. In principle, the following strategies exist to handle inconsistent factors: 1. Choice of a common reference scale, such that α = β. This involves an assumption that both factors are of similar magnitude and can be rescaled to a common reference. Typically, there is enough freedom in the equations to choose the reference length, time, or field scale to achieve this. A common example of this approach is the choice of reference time scale computed from the reference length and velocity scale in convection dominated problems. 2. Exploit the linearity of the equation and treat each term αg (v) and βh (v) separately. While this does not always resolve the possible numerical and conditioning issues, it explicitly acknowledges the presence of different scales in the problem. It suggests that some terms may be neglected in the overall formulation if their contribution is small compared to others. This approach is exercised in the examples on the Neo–Hooke elasticity and Poisson–Nernst–Planck equations in later sections. 3. Introduce auxiliary variables to reformulate the problem. Considering the example above, we divide by α

and introduce an auxiliary variable λ = ( β/α )h(v) where we take β/α ≫ 1, in order to demonstrate the ill-conditioned case. The system of equations then contains 

f (v, λ ) = g(v) + λ, (17) and the auxiliary variable λ is solved for in 

h(v) − 1

β/α λ = 0 , (18) which is well-conditioned. An example approach of this type for nearly incompressible elasticity is known as the Herrmann formulation (Herrmann, 1965), where the pressure is introduced as an auxiliary variable to handle the large bulk modulus. On the other hand, inconsistent dimensions indicate a mistake in the dimensional PDE. This is a severe problem, often caused by incorrect dimensional transformation, wrong units of the introduced quantities, or a more fundamental modeling mistake. 

Example (Factorizing the Poisson equation). This process is demonstrated in Fig. 4. The diagram illustrates how the factorizer traverses the DAG in a post-order manner (child nodes before parents), computing and annotating each node with its corresponding dimensional expression. At terminal nodes (e.g., variables u , δu ), the factorizer assigns appropriate dimensions based on their reference quantities. As it traverses up the tree, it applies dimensional transformation rules for each operator: multiplication combines dimensions via addition of dimension vectors, division subtracts dimension vectors, and gradient operations incorporate the reference length scale lref . The final result at the root node represents the consolidated dimensional expression for the entire bilinear form. In this case, u2ref l−2ref for the inner product of gradients. More specifically, in the Poisson example the root factor is stored as the vector in Q2:

d(Inner ) = (2 , −2) T (19) assuming the provided ordering of dimensional quantities (uref , l ref ).8Automated dimensional analysis for PDEs PREPRINT Inner u2ref l−2ref 

Division uref l−1ref 

Grad uref 

Product uref 

1 uref u 1

1 lref 

Division uref l−1ref 

Grad uref 

Product uref 

1 uref δu 1

1 lref 

Figure 4: Quantity factorized DAG with dimensional scales annotated on each node. This representation exposes the dimensional homogeneity of the expression ∇u · ∇ δu with final units u2ref l−2ref .

Example (Factorizing the Helmholtz equation). In order to demonstrate the handling of nonhomogeneous sums during factorization, we consider the weak form of the Helmholtz equation: 

−∆u + κ2u = f, (20) where κ > 0. The bilinear form corresponding to this equation is 

a(u, δu ) = 

Z

> Ω

 ∇u · ∇ δu + κ2u δu  dx. (21) The DAG of the integrand ∇u · ∇ δu + κ2uδu after transformation and factorization steps is shown in Fig. 5, where we skip the detailed subgraph for the inner product of gradients for brevity. Sum nonhomogeneous 

Inner u2ref l−2ref 

. . . 

Product κ2u2ref 

Product u2ref 

Product uref 

1 uref u 1

Product uref 

1 uref δu 1

Square κ2

1 κ

Figure 5: Factorized DAG for the nonhomogeneous sum ∇u · ∇ δu + κ2uδu . The sum node at the root shows inconsistency between its operands u2ref l−2ref and κ2u2ref .At this point, the factorizer detects that the Sum node is nonhomogeneous because its two operands carry different scale factors: 

u2ref l−2ref ̸ = κ2u2ref . (22) Firstly, it checks the dimensional consistency of the two factors. If they are dimensionally inconsistent, i.e. [u2ref l−2ref ]̸ =[κ2u2ref ], an exception is raised indicating a severe modeling error. It is clear from the above that for the dimensional consistency to hold, κ must have dimensions of inverse length, [κ] = L −1.More difficult is the case of consistent dimensions but inconsistent factors. In this case, the factorizer raises an exception indicating that the sum is nonhomogeneous. The user must then decide how to handle the inconsistent factors, e.g. by letting κ = l−1ref , as discussed earlier. 9Automated dimensional analysis for PDEs PREPRINT 

3.5 Normalization 

In this subsection, we describe the normalization step that produces dimensionless forms of variational problems. This step is based on the factorization step described in the previous subsection. Let us assume that a function F that describes the physical problem can be written as a sum of s terms fi, each a function of the n independent quantities {q1, . . . , q n}, i.e., 

F (q1, . . . , q n) = f1(q1, . . . , q n) + f2(q1, . . . , q n) + · · · + fs(q1, . . . , q n). (23) This is clearly a very restrictive assumption, but many physical problems can be expressed in this form, especially after linearization. The supporting assumption is that each term in the sum comes from a different physical effect or mechanism, each with its own characteristic scale. Typical examples include weak forms of PDEs, where each term in the bilinear or linear form represents a different physical contribution (e.g., diffusion, convection, reaction, source terms, etc.), energy functionals with multiple energy contributions, constrained optimization problems with various penalty terms, multiphysics problems coupling different physical fields, etc. Using the techniques explained in the previous subsection, the function is transformed and factorized into 

F = α1 bf1 + α2 bf2 + · · · + αs bfs, (24) where bfi are dimensionless (do not depend on any qi) and αi are dimensional scaling factors that carry the units of each term fi. The dimensional consistency requires that all αi have the same dimension, i.e., [αi] = [ αj ] for all 

i, j = 1 , . . . , s . To nondimensionalize the expression, we divide through by a carefully chosen reference factor αref ,which has the same dimension as the αi factors. This yields a dimensionless representation: 

Fαref 

= α1

αref 

bf1 + α2

αref 

bf2 + · · · + αs

αref 

bfs. (25) The coefficients αi/α ref are dimensionless numbers, ensuring that the entire expression is invariant under transformations of the underlying unit system. Using this approach, the dimensionless numbers (dimensionless groups) are defined uniquely, and we obtain s dimensionless groups for a sum of s terms. Importantly, these dimensionless groups are in general different from those obtained via Buckingham Pi analysis. If the groups identified via normalization are not the same as those from Buckingham Pi analysis, this could indicate that some of the terms fi are describing the same physical effect and could be combined, or that important physical effects are not captured in the expression F ,indicating their relevance in boundary or initial conditions. The reference factor αref is usually chosen as one of the αi factors, based on modeling requirements and the specific context of the problem. A common choice is to set αref = max i |αi|, i.e., as the most dominant term in the sum. 

Example (Normalizing the Helmholtz equation). Continuing the Helmholtz equation example from the previous subsection, we first write the bilinear form in the linear algebraic form: 

a(u, δu ) = a1(u, δu ) + a2(u, δu ), (26) where a1(u, δu ) = R 

> Ω

∇u·∇ δu dx and a2(u, δu ) = R 

> Ω

κ2u δu dx represent the weak Laplacian and mass contributions, respectively. After transformation and factorization (taking the topological dimension d), we obtain 

a = u2ref l−2ref ld 

> ref

ba1 + κ2u2ref ld 

> ref

ba2. (27) The choice of reference factor is application-dependent, depending on the dominant physical effects, i.e. if we expect diffusion or reaction to dominate the solution behavior. For an example here, we can choose αref = u2ref l−2ref ld 

> ref

, which yields the dimensionless form: aαref 

= ba1 + κ2l2ref ba2 (28) which introduces the trivial dimensionless group 1 and the dimensionless group κ2l2ref . This dimensionless group indicates the relative importance of the reaction term compared to the diffusion term in the Helmholtz equation. 

3.6 Multiphysics problems 

The framework to handle multiphysics problems requires minor extensions to the normalization step described in the previous subsection. In multiphysics problems, we typically have m different forms F1, F 2, . . . , F m, each representing 10 Automated dimensional analysis for PDEs PREPRINT 

a physical equation with its own set of quantities and own dimension. We proceed by transforming and factorizing each form separately, yielding 

F1 = α1,1 bf1,1 + α1,2 bf1,2 + · · · + α1,s 1

bf1,s 1 ,F2 = α2,1 bf2,1 + α2,2 bf2,2 + · · · + α2,s 2

bf2,s 2 ,

...

Fm = αm, 1 bfm, 1 + αm, 2 bfm, 2 + · · · + αm,s m

bfm,s m .

(29) The choice of the reference factor is more involved in multiphysics problems, as we have the freedom to choose a different reference factor for each form Fi. We denote these reference factors as αref ,i for i = 1 , . . . , m . Similar to the single-physics case, the reference factors can be chosen based on modeling requirements, e.g., to highlight dominant physical effects in each equation. An obvious choice is to set αref ,i = max j |αi,j |, i.e., the most dominant term in each form Fi. This could, however, neglect important coupling effects between different equations, so care must be taken in the choice of reference factors. In the context of the weak form of linearized PDEs, i.e. when each Fi is a bilinear or linear form, the individual equations are typically summed together to form a coupled system. In order to satisfy the dimensional consistency across this sum, it is required to choose the reference factors such that all normalized forms Fi/α ref ,i have the same dimension. This requirement ensures that the entire coupled system 

F = F1

αref ,1

+ F2

αref ,2

+ · · · + Fm

αref ,m 

(30) is dimensionally consistent. 

# 4 PDE nondimensionalization examples 

All examples in this section are available as demos in the GitHub repository of the Dolfiny package, see Habera, Kühner, and Zilian (2025). 

4.1 Incompressible Navier–Stokes 

The incompressible Navier–Stokes system is traditionally used as an example PDE to demonstrate nondimensional-ization and the appearance of dimensionless numbers. In its classical form we seek velocity v and pressure p such that 

ρ ∂v

∂t + ρ(v · ∇ )v − ∇ · (2 ρν D(v)) + ∇p = g,

∇ · v = 0 .

(31) Here, ρ is the fluid density, ν the kinematic viscosity, D(v) = 12 (∇v + ∇vT) the strain-rate tensor, and g is an external body force. The Navier–Stokes system depends on seven dimensional quantities: reference velocity vref , reference pressure pref ,reference force gref , reference time tref , reference length lref , density ρ, and kinematic viscosity ν. We can define these using the Quantity class, see Fig. 6. Example values are provided to demonstrate the dimensional analysis output. The output of the above code snippet is shown in Fig. 7. Buckingham Pi analysis lists each quantity with its symbolic representation, value in base SI units, the dimension matrix, and the resulting dimensionless groups. The dimensional matrix is of size 7 × 7, since there are seven quantities and seven fundamental dimensions. The ordering of columns and rows corresponds to the order of provided quantities and SI base dimensions, respectively. The automated analysis identifies four dimensionless groups: 

Π1 = νlref vref 

= 1Re (inverse Reynolds number) ,

Π2 = gref lref 

v2ref 

= 1Fr 2 (squared inverse Froude number) ,

Π3 = pref 

ρv 2ref 

= Eu (Euler number) ,

Π4 = tref 

lref /v ref 

= 1St (inverse Strouhal number) .

(32) 11 Automated dimensional analysis for PDEs PREPRINT  

> 1

import sympy.physics.units as syu  

> 2

from sympy import Symbol  

> 34

from dolfiny.units import Quantity, buckingham_pi_analysis  

> 56

nu = Quantity(mesh, 1000, syu.millimeter**2 / syu.second, "nu")  

> 7

rho = Quantity(mesh, 5000, syu.kilogram / syu.m**3, "rho")  

> 8

l_ref = Quantity(mesh, 1, syu.meter, "l_ref")  

> 9

t_ref = Quantity(mesh, 1 / 60, syu.minute, "t_ref")  

> 10

v_ref = Quantity(mesh, 1, syu.meter / syu.second, "v_ref")  

> 11

p_ref = Quantity(mesh, 5000, syu.pascal, "p_ref")  

> 12

g_ref = Quantity(mesh, 10, syu.meter / syu.second**2, "g_ref")  

> 13 14

quantities = [v_ref, l_ref, rho, nu, g_ref, p_ref, t_ref]  

> 15

buckingham_pi_analysis(quantities) 

Figure 6: Definition of reference quantities for the Navier–Stokes system using the Quantity class. Each quantity includes its symbolic representation and corresponding SI units. In fact, the dimensionless groups correspond to the classical dimensionless numbers used in fluid mechanics. The Reynolds number characterizes the ratio of inertial to viscous forces, the Froude number relates inertial to gravitational forces, the Euler number compares pressure forces to inertial forces, and the Strouhal number describes oscillating flow dynamics. In this context, however, the (inverse) Strouhal number characterizes the ratio of the reference time scale to the convective time scale, so could also be called a global Courant-Friedrichs-Lewy (CFL) number. The appearance of these classical dimensionless numbers through Buckingham Pi analysis is more of a coincidence rather than a guarantee. As discussed previously, other independent products of dimensionless groups can be formed by combining the identified groups. The specific outcome of the groups in this example is due to the particular choice of the algorithm used to compute a basis of the null space of the dimension matrix. We use the SymPy implementation of the Matrix.nullspace() method, especially for matrices over the rational field Q, see Meurer, Smith, Paprocki, et al. (2017). The algorithm tends to produce basis vectors with small integer coefficients, which often correspond to classical dimensionless numbers in physics and engineering. The only remaining variable is the choice of ordering of the list of quantities provided. So far, no PDE formulation has been considered in the dimensional analysis. Let us now write the weak form of the incompressible Navier–Stokes equations. The problem becomes: find (v, p ) ∈ V × P such that 

Z

> Ω

ρ ∂v

∂t ·δv dx+ 

Z

> Ω

ρ(v·∇ )v·δv dx+ 

Z

> Ω

2ρν D(v) : D(δv) dx −

Z

> Ω

p∇· δv dx −

Z

> Ω

∇· vδp dx = 

Z

> Ω

g·δv dx (33) holds for all (δv, δp ) ∈ V × P . The matrix formulation of this nonlinear saddle-point system can be expressed as 

At + Ac + Av BT

B 0

  v

p



=

g0



(34) where the operators are defined as 

(Atv, δ v) = 

Z

> Ω

ρ ∂v

∂t · δv dx , (Acv, δ v) = 

Z

> Ω

ρ(v · ∇ )v · δv dx ,

(Av v, δ v) = 

Z

> Ω

2ρν D(v) : D(δv) dx , (Bv, δp ) = −

Z

> Ω

∇ · v δp dx ,

(BTp, δ v) = −

Z

> Ω

p∇ · δv dx .

(35) Going back to Eq. (33) and Eq. (23), the top-level expression is a sum of six terms so we write 

FNS (vref , p ref , g ref , t ref , l ref , ρ, μ ) = ( Atv, δ v)

| {z }

> (unsteady)

+ ( Acv, δ v)

| {z }

> (convection)

+ ( Av v, δ v)

| {z }

> (viscous)

+ (Bv, δp )

| {z }

> (incompressibility)

+ ( BTp, δ v)

| {z }

> (pressure)

− (g, δ v)

| {z } 

> (force)

= 0 .

(36) 12 Automated dimensional analysis for PDEs PREPRINT 

Symbol Expression Value (base units) 

vref 1 m /s 1 m /s

lref 1 m 1 m 

ρ 5000 kg /m3 5000 kg /m3

ν 1000 mm 2/s 0.001 m 2/s

gref 10 m /s2 10 m /s2

pref 5000 Pa 5000 kg /(ms 2)

tref 0.016 67 min 1 s 

> (a) Physical quantities

Dim. vref lref ρ ν gref pref tref 

L 1 1 −3 2 1 −1 0M 0 0 1 0 0 1 0T −1 0 0 −1 −2 −2 1  

> (b) Dimension matrix (only non-zero rows shown: N, I, J, Θall zero)

Group Expression Value 

Π1 ν/ (lref vref ) 0.001 

Π2 gref lref /v 2 

> ref

10 

Π3 pref /(ρv 2

> ref

) 1

Π4 tref vref /l ref 1

> (c) Dimensionless groups

Figure 7: Buckingham Pi dimensional analysis for the Navier–Stokes system. This output was generated by the automated dimensional analysis framework presented in this work. For the dimensionless form of the equations, we have to proceed with transformation and factorization steps, see subsections 3.3 and 3.4. Since UFL does not have built-in support for time derivatives, we discretize the time derivative using the backward Euler scheme: 

∂v

∂t ≈ v − v0

tref ∆t , (37) where v0 is the velocity at the previous time step and ∆t the dimensionless time step size. The specific choice of time discretization is not important for the dimensional analysis. We introduce dimensional transformations as 

v 7 → vref v, v0 7 → vref v0, p 7 → pref p, δv 7 → vref δv, δp 7 → pref δp (38) together with the transformation of spatial differential operators and integration measures based on the characteristic length of the mesh, lref . Introduction of the reference gravitational force using gref is done manually in the weak form. In the implementation, we define these transformations using a dictionary that maps each UFL dimensionless node to its corresponding dimensional node as shown in Fig. 8. It is important to notice that test functions δv and δp are transformed too. This is required for the dimensional consistency of the mixed weak form in Eq. (33). In order to tag individual terms in the weak form, we use another dictionary to associate each term with a descriptive name. This allows us to easily identify and manipulate the terms later in the code. 2

The dictionary definition for tagging terms, factorization, and normalization calls is shown in Fig. 9. The factorize 

function performs the dimensional transformation and factorization of each term in the terms dictionary. The result is another dictionary called factorized where each term is represented as a product of a dimensional factor and a 

> 2The dictionary serves as an external tagging mechanism. UFL does not have a tagging mechanism where expressions or forms could be tagged and the tagged information would persist through consequent form manipulation.

13 Automated dimensional analysis for PDEs PREPRINT  

> 1

mapping = {  

> 2

mesh.ufl_domain(): l_ref,  

> 3

v: v_ref * v,  

> 4

v0: v_ref * v0,  

> 5

p: p_ref * p,  

> 6

δv: v_ref * δv,  

> 7

δp: p_ref * δp,  

> 8

}

Figure 8: Dimensional transformation mapping for the Navier–Stokes weak form variables and operators. Each key-value pair associates a UFL object with its dimensional counterpart.  

> 1

from dolfiny.units import factorize, normalize  

> 23

terms = {  

> 4

"unsteady": ufl.inner( δv, rho * (v - v0) / (t_ref / n)) * ufl.dx,  

> 5

"convection": ufl.inner( δv, rho * ufl.dot(v, ufl.grad(v))) * ufl.dx,  

> 6

"viscous": ufl.inner(D( δv), 2 * rho * nu * D(v)) * ufl.dx,  

> 7

"incompressibility": ufl.inner( δp, ufl.div(v)) * ufl.dx,  

> 8

"pressure": -ufl.inner(ufl.div( δv), p) * ufl.dx,  

> 9

"force": -ufl.inner( δv, rho * g_ref * b) * ufl.dx,  

> 10

} 

> 11

factorized = factorize(terms, quantities, mode="factorize", mapping=mapping)  

> 12 13

reference_term = "convection"  

> 14

normalized = normalize(factorized, reference_term, quantities) 

Figure 9: Code implementation for dimensional transformation and factorization of the Navier–Stokes weak form terms. The dictionary terms defines each component of the mixed weak formulation, while mapping establishes the dimensional transformations for all variables and operators. dimensionless UFL expression. The normalize function then divides each term by the dimensional factor of the specified reference term. In this example we take the “convection” term. This is the implementation of the process described in the subsection 3.5. The output of the dimensional factorization and normalization is shown in Fig. 10. 

Expression lref ρv 3

> ref

Value (base units) 5000 kgm /s3

(a) Reference factor from “convection” 

Term Factor Value 

unsteady lref /(tref vref ) 1convection 1 1viscous ν/ (lref vref ) 0.001 pressure pref /(ρv 2

> ref

) 1force gref lref /v 2 

> ref

10 incompressibility pref /(ρv 2

> ref

) 1

(b) Normalized terms 

Figure 10: Automated dimensional factorization and normalization for the Navier–Stokes weak form. Each term is expressed with respect to the reference factor from the convection term, resulting in dimensionless coefficients. This output was generated by the dimensional analysis framework presented in this work. 14 Automated dimensional analysis for PDEs PREPRINT 

Let us now walk through the steps to obtain the dimensionless form of the Navier–Stokes system in detail. The transformed and factorized form reads (for two-dimensional case, d = 2 )

FNS = ρv 2ref t−1ref l2ref (Atv, δ v) + ρv 3ref lref (Acv, δ v) + μv ref (Av v, δ v)+ pref vref lref (BTp, δ v) + pref vref lref (Bv, δp ) − gref vref l2ref (g, δ v)= 0 ,

(39) and with the choice of normalization for convection dominated problems, i.e. setting αref = ρv 3ref lref we obtain 

FNS 

αref 

= lref 

tref vref 

(Atv, δ v) + ( Acv, δ v) + μρv ref lref 

(Av v, δ v)+ pref 

ρv 2ref 

(BTp, δ v) + pref 

ρv 2ref 

(Bv, δp ) − gref lref 

v2ref 

(g, δ v)= 0 .

(40) Using the previously defined dimensionless numbers (Strouhal, Reynolds, Euler, and Froude) we can write the system in the dimensionless matrix form: 

St At + Ac + 1Re Av Eu BT

Eu B 0

  v

p



=

 1Fr 2 g0



. (41) In addition to the nondimensionalization, a helper function get_dimension is provided. It can be used to fetch dimensions of arbitrary symbolic UFL expressions or forms. This allows for sanity checks in the user code, as shown in Fig. 11.    

> 1from dolfiny.units import get_dimension
> 23dimsys = syu.si.SI.get_dimension_system()
> 4assert dimsys.equivalent_dims(get_dimension(D(v), quantities, mapping), 1 / syu.time)

Figure 11: Example of using dolfiny.units.get_dimension to check the dimensions of UFL expressions. The assertion checks that the dimension of the strain–rate tensor [D(u)] = T −1. Equivalency of dimensions is verified using SymPy’s SI dimension system. 

Conditioning of the Navier–Stokes system. Let us now explore the choice of the reference quantities in the Navier– Stokes system. The main motivation is to find a set of reference quantities that lead to a well-conditioned linear system in the dimensionless form, Eq. (41) . There are seven dimensional quantities in the FNS system, but two of them, density 

ρ and kinematic viscosity ν, are material properties and cannot be chosen freely. In the choice of vref and pref we have the complete freedom, i.e. any positive values will be factored out of the system and the dimensional velocity vref v and dimensional pressure pref p will be independent of the choice of vref and pref .For the sake of simplicity, we’ll assume that the linearized and discretized Navier–Stokes system leads to a matrix problem of the form  A Eu BT

Eu B 0

| {z }

> K(Eu)

v

p



=

 1Fr 2 g0



(42) where A is the linearized and discretized operator for the unsteady, convection and viscous terms. For the purpose of this example we’ll examine the conditioning of the matrix K(Eu) ∈ RN ×N as a function of the dimensionless Euler number Eu . The matrix has N = n + m rows and columns, where n is the number of velocity degrees of freedom and 

m the number of pressure degrees of freedom. We’ll assume that the matrix A is provided and omit the discussion of the dependence of its spectrum on the Strouhal and Reynolds numbers. This is an oversimplification, but it allows us to focus on the influence of the Euler number on the conditioning, as a prototype for other saddle-point systems. As can be seen in Fig. 12, the 2-norm condition number κ2(K) of the Navier–Stokes matrix K(Eu) is highly sensitive to the choice of the pressure reference scale pref , which is controllable through the dimensionless Euler number 

Eu = pref /(ρv 2ref ). The naive choice of pref = 1 Pa (and in turn Eu = 0 .0002 ) leads to an ill-conditioned system. In Appendix A, we show that there exists a constant C > 0 independent of Eu such that 

κ2(K) ≥ C Eu −2m/N . (43) 15 Automated dimensional analysis for PDEs PREPRINT 0 0.5 1 1.5 2

10 3

10 4

Eu 

> κ2(K)

Figure 12: Condition number κ2 of the Navier–Stokes matrix K(Eu) as a function of the Euler number. The plot demonstrates how the choice of pressure reference scale pref affects the numerical conditioning of the linearized system. The condition number was measured using NumPy’s linalg.cond resulting from a 10 × 10 triangular mesh and Taylor-Hood P2 − P1 discretization. In other words, as the Euler number Eu → 0, the condition number κ2(K) → ∞ . This is clearly visible in Fig. 12. The result is not surprising, since the Euler number scales the off-diagonal block B, and this block is essential for the invertibility of the saddle-point system. In addition, for values of Eu > 1.2 the condition number stabilizes and remains nearly constant. This happens because the smallest singular value σ1 of the matrix K becomes determined by the velocity block A rather than the off-diagonal incompressibility block B.With these observations, we can conclude that the reference pressure scale in this example should be made sufficiently large, i.e. pref > 5000 Pa (such that Eu > 1), to ensure numerical stability and conditioning of the linearized Navier–Stokes system. 

Relation to matrix preconditioning. In more general terms, the nondimensionalization can be seen as a simple diagonal preconditioning technique that improves the conditioning of the resulting linear systems. This is particularly important when solving multiphysics problems where different physical processes interact. Consider the algebraic system of the linearized Navier–Stokes equations corresponding to the dimensional weak form (before applying transformations of v and p and before normalization): 

ρt −1ref l2ref At + ρl ref Ac + μAv lref BT

lref B 0

| {z }

> eK

v

p



=

gref l2ref g0



. (44) The nondimensionalization process is mathematically equivalent to applying a two-sided (left and right) diagonal preconditioner K = Dl eKD r . The transformations are: 1. Right preconditioning (transformation of variables). Substituting dimensional variables with scaled dimension-less ones ( v 7 → vref v, p 7 → pref p) is equivalent to right-multiplying the system by 

Dr =

vref I 00 pref I



. (45) 2. Left preconditioning (test function scaling and normalization). Scaling the test functions ( δv 7 → vref δv, δp 7 →

pref δp ) and dividing the entire system by the reference scale ( αref = ρv 3ref lref ) is equivalent to left-multiplying by 

Dl = 1

ρv 3ref lref 

vref I 00 pref I



. (46) The left and right preconditioned system matrix is equivalent to the dimensionless system in Eq. (41) . From a numerical linear algebra perspective, this procedure is a form of matrix equilibration (Sluis, 1969). However, unlike algebraic equilibration which scales blindly based on matrix entry magnitudes, nondimensionalization scales based on physical characteristic units. This physics-aware scaling is robust against numerical noise and helps cluster eigenvalues, thereby improving the convergence rate of Krylov subspace solvers (e.g., GMRES) for multiphysics problems. 16 Automated dimensional analysis for PDEs PREPRINT 

Relation to Full Operator Preconditioning. It is crucial to distinguish between algebraic preconditioning and the operator-level transformation presented here. Recent work by Mohr, Nakatsukasa, and Urzúa-Torres (2024) introduces the concept of Full Operator Preconditioning (FOP) to describe techniques that modify the underlying partial differential operator prior to discretization, contrasting them with standard preconditioning which operates on the already assembled matrix. While the nondimensionalization described in the previous section is algebraically equivalent to diagonal scaling 

K = Dl eKD r , the numerical realization differs fundamentally. Standard preconditioning assembles the ill-conditioned matrix eK first, and subsequently applies Dl and Dr during the iterative solve. In contrast, our framework applies the scaling weights directly to the variational form before assembly. We assemble K directly, effectively commuting the operations of discretization and scaling. This distinction has significant implications for floating-point accuracy. As demonstrated by Mohr, Nakatsukasa, and Urzúa-Torres (2024), assembling eK involving quantities with disparate magnitudes (e.g., 1 and 10 −15 ) can lead to catastrophic cancellation or loss of significant digits in finite precision arithmetic. Algebraic preconditioning cannot recover this lost information. By enforcing unit consistency at the UFL level, our framework implements the simplest form of the Full Operator Preconditioning, ensuring that the assembly process operates on O(1) quantities, thereby preserving the numerical accuracy of the discrete operator. The effect of the row-column equilibration on the accuracy of the solution is also noted in Golub and Van Loan (2013, §3.5.2). The accuracy as the driving principle for nondimensionalization is further discussed in the following section on hyperelasticity. 

4.2 Neo–Hooke hyperelasticity 

A displacement u ∈ U0 of a hyperelastic material solves 

min 

> u∈U0

Z

> Ω

˜W (u) d x − Wext (u), (47) where ˜W : U0 → R is the strain energy density function. One common form of the compressible Neo–Hooke material model ˜W = ˜Wshear + ˜Wbulk = μ

2 (I1 − 3 − 2 ln J)

| {z }

> shear term

+ κ

2 (J − 1) 2

| {z }

> bulk term

, (48) is defined in Pence and Gou (2014, Eq. (1.4)). Here, I1 = tr( C) is the first invariant of the right Cauchy–Green deformation tensor C = FTF with the deformation gradient F = I + ∇u. Here, J = √det C = |det F| is the Jacobian of the deformation, and μ and κ the shear and bulk moduli, respectively. External work done by traction on the boundary ΓN is given by 

Wext =

Z

> ΓN

t · u ds (49) where t is the boundary traction. In this example, we restrict ourselves to three-dimensional problems, d = 3 . The Neo–Hooke hyperelasticity problem depends on five dimensional quantities: reference displacement scale uref , reference traction τref , reference length lref ,shear modulus μ, and bulk modulus κ. These can be introduced using the Quantity class as shown in Fig. 13. In the code, Poisson’s ratio ν, Young’s modulus E, and Lamé’s first parameter λ are auxiliary quantities used to define μ and 

κ so are not included in the dimensional analysis. The output of the Buckingham Pi dimensional analysis is shown in Fig. 14. The automated analysis identifies three dimensionless groups: 

Π1 = κμ (bulk to shear ratio) ,

Π2 = τref 

μ (traction to shear ratio) ,

Π3 = uref 

lref 

(displacement to length ratio) .

(50) The first Pi group Π1 expresses the ratio of bulk to shear modulus, which is related to the relative contribution of the respective energy terms in the strain energy density function. The second group Π2 relates the reference traction to the shear modulus, indicating the relative magnitude of external loading compared to the material’s shear resistance. The third group Π3 compares the reference displacement to the reference length, providing a measure of the deformation scale relative to the characteristic size of the domain. 17 Automated dimensional analysis for PDEs PREPRINT  

> 1

import sympy.physics.units as syu  

> 2

from sympy import Symbol  

> 34

from dolfiny.units import Quantity, buckingham_pi_analysis  

> 56

nu = 0.4  

> 7

E = Quantity(mesh, 2, syu.giga * syu.pascal, "E")  

> 8

λ = Quantity(mesh, E.scale * nu / ((1 + nu) * (1 - 2 * nu)), E.unit, " λ")  

> 910

μ = Quantity(mesh, E.scale / (2 * (1 + nu)), E.unit, " μ")  

> 11

κ = Quantity(mesh, λ.scale + 2 / 3 * μ.scale, E.unit, " κ")  

> 12 13

l_ref = Quantity(mesh, 1.0, syu.millimeter, "l_ref")  

> 14

τ_ref = Quantity(mesh, 100, syu.kilo * syu.pascal, " τ_ref")  

> 15

u_ref = Quantity(mesh, 0.001, syu.millimeter, "u_ref")  

> 16 17

quantities = [ μ, κ, l_ref, τ_ref, u_ref]  

> 18

buckingham_pi_analysis(quantities) 

Figure 13: Definition of reference quantities for the Neo–Hooke hyperelasticity system using the Quantity class. Each quantity includes its symbolic representation and corresponding SI units. For a hyperelastic material, the second Piola-Kirchhoff stress tensor S is given by 

S = ∂ ˜W∂E = 2 ∂ ˜W∂C . (51) The weak form reads: find u ∈ U0 such that 

− 12

Z

> Ω

S : ∂C

∂u [δu] d x +

Z

> ΓN

t · δu ds = 0 (52) holds for all δu ∈ U0, where ∂C 

> ∂u

[δu] is the Gâteaux derivative of the right Cauchy-Green deformation tensor in the direction of δu.Mapping that introduces dimensional transformations is chosen as 

u 7 → uref u, δu 7 → uref δu, (53) and is complemented by the spatial scaling of the differential operators and integration measures with the reference length lref . Introduction of the scaling for the traction force based on the reference traction τref is done manually in the weak form. The dimensional factorization attempt correctly identifies a potential issue and raises an exception. The exception message reads: 

RuntimeError: Inconsistent factors I---> + { A | A_{i_{25}, i_{26}} = (grad({ A | A_{i_{22}} = ... }. Different factors: 1 != u_ref/l_ref. 

The factorization process detects an inconsistency of factors, as described in subsection 3.4. Specifically, the deformation gradient cannot be factorized homogeneously in terms of the reference quantities uref and lref . The gradient operator introduces a division by the length scale lref , while the displacement field u is scaled by the displacement scale uref .This produces the transformed expression: 

F = I + uref 

lref 

∇u = I + Π 3∇u. (54) We add two quantities of potentially vastly different magnitudes. One possible solution is to choose the reference displacement scale to match the reference length scale, uref = lref , so that both terms in the sum are of the same order of magnitude. However, this choice is only valid if the expected displacements are of the same order as the domain size, which is not the case for small deformations. 18 Automated dimensional analysis for PDEs PREPRINT 

Symbol Expression Value (base units) 

μ 7.143 × 10 8 Pa 7.143 × 10 8 kg /(ms 2)

κ 3.333 × 10 9 Pa 3.333 × 10 9 kg /(ms 2)

lref 1 mm 0.001 m 

τref 1 × 10 5 Pa 1 × 10 5 kg /(ms 2)

uref 0.001 mm 1 × 10 −6 m

> (a) Physical quantities

Dim. μ κ lref τref uref 

L −1 −1 1 −1 1M 1 1 0 1 0T −2 −2 0 −2 0  

> (b) Dimension matrix (only non-zero rows shown: N, I, J, Θall zero)

Group Expression Value 

Π1 κ/μ 4.67 

Π2 τref /μ 0.00014 

Π3 uref /l ref 0.001 

> (c) Dimensionless groups

Figure 14: Buckingham Pi dimensional analysis for the Neo–Hooke hyperelasticity system. This output was generated by the automated dimensional analysis framework presented in this work. The inconsistency of factors could manifest as numerical instability in the solution process, especially when the dimensionless group Π3 = uref /l ref is very small or very large. To demonstrate this, consider the setup of Π3 = 10 −k,which for large k is a limit of small deformations. Evaluation of the deformation gradient leads to losing k digits of accuracy. In an extreme case of Π3 = 10 −16 , the deformation gradient evaluates to identity matrix in IEEE 754 double precision arithmetic, losing all information about the deformation. In contrast, starting from the linearized strain energy density function and introducing the Green-Lagrange strain 

E = 12 (C − I) = 12 (FTF − I), (55) allows us to rescale the displacement field without losing the relative accuracy. The issue of numerical stability in hyperelastic material models is discussed in more detail in Shakeri et al. (2024). 

Reformulation using Green-Lagrange strain split. The strain energy density function can be reformulated in terms of the Green-Lagrange strain E, see Appendix B, as 

˜W = μ (tr( E) − ln J) + κ

2 (J − 1) 2,J = pdet( I + 2 E).

(56) This form is not suitable for dimensional factorization either, since the determinant term J still contains expressions of form 1 + O(Π 3). However, we can expand the strain energy density function in terms of the dimensionless group Π3

assuming small deformations, i.e., 

˜W = ˜W (2) + ˜W (3) + O(Π 43), (57) where ˜W (2) and ˜W (3) are the second- and third-order terms in the expansion, respectively. In order to achieve the homogeneity in the dimensional quantities μ, κ, lref , and uref , we express the linearized Neo–Hooke strain energy density as 

˜W = μ tr  E21

| {z } 

> ˜W(2)
> μ

+ κ

2 tr( E1)2

| {z } 

> ˜W(2)
> κ

+ μ



2E1 : E2 − 43 tr  E31

| {z } 

> ˜W(3)
> μ

+ κ



tr( E1) tr( E2) − 12 tr( E1)3| {z } 

> ˜W(3)
> κ

+O(∥E∥4), (58) 19 Automated dimensional analysis for PDEs PREPRINT 

where E1 = 12 (∇u + ∇uT) is the linearized strain tensor and E2 = 12 ∇uT∇u is the second-order nonlinear correction. The reason for this split is that all four terms are now homogeneous in the dimensional quantities, and they are grouped to represent the second- and third-order contributions in terms of the dimensionless group Π3 and the bulk and shear effects. The definition of the weak form terms and their dimensional transformation follows the same pattern as in the previous examples, see Fig. 9 for reference. We define four terms “shear_2”, “bulk_2”, “shear_3”, and “bulk_3” corresponding to the second- and third-order contributions from shear and bulk parts of the strain energy density function, respectively. The external force term is defined as “force”. 

Expression lref u2

> ref

κ

Value (base units) 3.333 × 10 −6 kgm 2/s2

> (a) Reference factor from “bulk_2”

Term Factor Value 

shear_2 μ/κ 0.2143 bulk_2 1 1shear_3 uref μ/ (lref κ) 0.0002143 bulk_3 uref /l ref 0.001 force lref τref /(uref κ) 0.03 

> (b) Normalized terms

Figure 15: Automated dimensional factorization and normalization for the Neo–Hooke hyperelasticity weak form. Each term is expressed with respect to the reference factor from the bulk term, resulting in dimensionless coefficients. This output was generated by the dimensional analysis framework presented in this work. The result of the dimensional factorization and normalization is shown in Fig. 15. The reference factor is chosen from the bulk second-order term. After normalization, we observe the appearance of dimensionless coefficients corresponding to the previously identified Π groups. For the example values of the reference quantities defined in Fig. 13, we observe that the shear contribution is approximately 21% of the bulk contribution, indicating a material behavior dominated by volumetric effects. The third-order contributions are significantly smaller, reflecting the small deformation assumption inherent in the expansion. The external force term is also relatively small, suggesting that the applied traction is moderate compared to the material’s bulk stiffness. Dimensionless form of the Neo–Hooke hyperelasticity is summarized in Appendix C. 

4.3 Poisson–Nernst–Planck 

The following demonstrates the use of the dimensional analysis framework for the multiphysics Poisson–Nernst–Planck (PNP) equations. The PNP system models the transport of charged species under the influence of an electric field. It consists of the Nernst–Planck model for the flux of ion concentrations coupled with the Poisson equation for the electric potential. The PNP model is taken from Samson and Marchand (1999). There are N equations of mass conservation for the N ion concentrations ci:

∂c i

∂t + ∇ · ji = 0 , i = 1 , . . . , N, (59) where the flux ji is given by the Nernst–Planck equation: 

ji = −Di



∇ci + ziFRT ci∇φ + ci∇ ln( γi)



. (60) Here ci is the concentration of species i (in mol /m3), Di is the diffusion coefficient (in m2/s), zi is the valence (dimensionless), F = 9 .6485 × 10 4 C/mol is the Faraday constant, R = 8 .3145 J /(molK) is the universal gas constant, T is the absolute temperature (in K), φ is the electric potential (in V), and γi is the activity coefficient (dimensionless). The extended Debye–Hückel model is given by 

ln( γi) = − Az 2

> i

√I

1 + Ba i

√I , (61) 20 Automated dimensional analysis for PDEs PREPRINT 

where A and B are the temperature-dependent Debye–Hückel constants computed from 

A =

√2F 2e0

8π(ϵRT )3/2 , B =

r 2F 2

ϵRT , (62) and e0 = 1 .6022 × 10 −19 C is the elementary charge, ϵ = ϵ0ϵr is the permittivity of the medium computed from the dimensionless relative permittivity ϵr and the permittivity of vacuum ϵ0 (in F/m) and ai is the radius of the ion (in m). The ionic strength I of the solution is defined as 

I = 12

> N

X

> i=1

(z2 

> i

ci + w). (63) Finally, the Poisson equation for the unknown electric potential φ reads 

− ∇ · (ϵ∇φ)

| {z }

> potential

− F

> N

X

> i=1

zici + w

!| {z }

> electroneutrality

= 0 . (64) In this example we consider a system with four ionic species: SO 42 – , Mg 2+ , Na +, and K+. Their valences are 

zi = ( −2, 2, 1, 1) , their ionic radii are ai = (6 , 8, 4, 3) lref where lref = 1 Å is the reference length scale and their diffusion coefficients are Di = (3 , 3, 3, 5) Dref where Dref = 1 × 10 −10 m2/s is the reference diffusion coefficient. The ordering in the vector notation corresponds to the species order above, i.e. i = (SO 42−, Mg 2+ , Na +, K+). Importantly, we do not introduce each individual diffusion coefficient and ionic radius as separate dimensional quantities, but we use reference quantities Dref and lref to express them in a nondimensional form. This choice is justified because the diffusion coefficients and ionic radii differ only by small factors of order O(1) . In addition, this simplifies the dimensional analysis and reduces the number of resulting Π groups. Moreover, we look for a steady-state solution and simplify the mass conservation to 

∇ · (Di∇ci)

| {z }

> diffusion

+ ∇ · 

 ziFRT Dici∇φ

| {z }

> convection

+ ∇ · (Dici∇ ln( γi)) 

| {z }

> Debye

= 0 , i = 1 , . . . , 4. (65) For brevity, we omit the definition of the dimensional quantities, which is similar to the previous examples. The result of the automated Buckingham Pi dimensional analysis is shown in Fig. 16. The automated analysis identifies three dimensionless groups: 

Π1 = RT /F φref 

(thermal voltage to reference voltage) ,

Π2 = lref 

pϵ0φref /(F c ref ) (reference length to Debye length) ,

Π3 = e0

√F c ref 

(ϵ0φref )3/2 = e0/(ϵ0φref )

pϵ0φref /(F c ref ) (Coulomb length to Debye length) .

(66) The first group Π1 represents the ratio of the thermal voltage VT = RT /F to the reference voltage φref . This number characterizes the energy scale of thermal fluctuations relative to the electric potential energy set by the reference voltage. The second group Π2 compares the reference length scale to the Debye length λD = pϵ0φref /(F c ref ), which indicates the distance over which electric potential decays in the electrolyte. A small value of Π2 suggests that the reference length is much smaller than the Debye length, implying weak screening effects. The third group Π3 relates the Coulomb length to the Debye length. The Coulomb length indicates the distance at which electrostatic interactions between ions become significant compared to thermal energy. Note, that the standard definitions of the Debye length and Coulomb length typically involve the thermal voltage VT , but here they are expressed in terms of the reference voltage φref . The relation to the standard definition can be recovered with the help of the first Pi group Π1. This mixing of the reference voltage and thermal voltage arises as the consequence of the non-unique choice of the basis of the kernel of the dimension matrix, as discussed multiple times in this work. 21 Automated dimensional analysis for PDEs PREPRINT 

Symbol Expression Value (base units) 

cref 50 mol /m3 50 mol /m3

φref 1 V 1 kgm 2/(As 3)

Dref 1 × 10 −10 m2/s 1 × 10 −10 m2/s

ϵ0 8.854 × 10 −12 F/m 8.854 × 10 −12 A2s4/(kgm 3)

F 9.649 × 10 4 C/mol 9.649 × 10 4 As /mol 

R 8.314 J /(Kmol) 8.314 kgm 2/(Kmols 2)

T 300 K 300 K 

lref 1 Å 1 × 10 −10 m

e0 1.602 × 10 −19 C 1.602 × 10 −19 A s 

> (a) Physical quantities

Dim. cref φref Dref ϵ0 F R T lref e0

N 1 0 0 0 −1 −1 0 0 0I 0 −1 0 2 1 0 0 0 1L −3 2 2 −3 0 2 0 1 0M 0 1 0 −1 0 1 0 0 0

Θ 0 0 0 0 0 −1 1 0 0T 0 −3 −1 4 1 −2 0 0 1

> (b) Dimension matrix (only non-zero rows shown: J all zero)

Group Expression Value 

Π1 RT / (F φ ref ) 0.0259 

Π2

√F c ref lref /√ϵ0φref 0.0738 

Π3

√F c ref e0/(ϵ0φref )3/2 13.4 

> (c) Dimensionless groups

Figure 16: Buckingham Pi dimensional analysis for the Poisson–Nernst–Planck system. This output was generated by the automated dimensional analysis framework presented in this work. The Poisson–Nernst–Planck multiphysics example requires transformation, factorization and normalization executed on two coupled variational forms independently: one for the Nernst-Planck equations (59) and one for the Poisson equation (64) . These two weak forms have different physical dimensions and they require different reference factors 

αref for normalization. Transformation step is based on the following mapping: 

ci 7 → cref ci, φ 7 → φref φ, δc i 7 → cref δc i, δφ 7 → δφ ref δφ, (67) which is again complemented by the spatial scaling of the differential operators and integration measures with the reference length lref . An important detail is the definition of the fixed charge concentration w appearing in both the Nernst–Planck and Poisson equations. We transform the fixed charge concentration as w 7 → cref 

PNi=1 c(0)  

> i

zi, i.e. in terms of the reference concentration cref and the initial concentrations c(0)  

> i

of each species and their valences zi. This step is necessary to ensure that the electroneutrality condition and the ionic strength are homogeneous in the reference concentration cref . If the fixed charge concentration was defined using an independent reference scale, say wref , the dimensional factorization would raise an exception due to inconsistent factors. Similarly, we express the ion radii ai

using the reference length lref .The Poisson equation weak form contains two terms labeled “potential” and “electroneutrality”, as denoted in Eq. (64) . We choose the reference factor from the "potential" term, which leads to the outcome as shown in Fig. 17. The dimensionless group specific to the Poisson equation is the square of the second Pi group Π22, which appears in the 22 Automated dimensional analysis for PDEs PREPRINT 

normalization of the “electroneutrality” term. This reflects the balance between the electric field contribution and the charge density contribution in the Poisson equation. 

Expression ϵ0φ2

> ref

/l ref 

Value (base units) 0.088 54 kg /s2

> (a) Reference factor from “potential”

Term Factor Value 

potential 1 1electroneutrality F c ref l2

> ref

/(ϵ0φref ) 0.005449 

> (b) Normalized terms

Figure 17: Automated dimensional factorization and normalization for the Poisson equation weak form in the Poisson– Nernst–Planck system. Each term is expressed with respect to the reference factor from the potential term, resulting in dimensionless coefficients. This output was generated by the dimensional analysis framework presented in this work. The Nernst–Planck equations are less straightforward to factorize, due to the presence of the Debye term ∇ ln( γi).Even though the activity coefficient γi is dimensionless, and so is its logarithm, the computation of ln( γi) from the extended Debye–Hückel model (Eq. 61) involves the term 1 + Ba i

√I in the denominator, which is not homogeneous in the chosen set of dimensional quantities. The factorization process detects this inconsistency and raises an exception, similar to the Neo–Hooke hyperelasticity case. To resolve this, we follow the similar approach to the Neo–Hooke example and expand the extended Debye–Hückel model using a Taylor series for small ion radii ai:

ln( γi) = −Az 2

> i

√I + ABa iz2 

> i

I + O(a2 

> i

). (68) This expansion allows us to split the Debye term into two contributions: constant in the ion radius ai and linear in ai,which we term “debye_0th” and “debye_1st”, respectively. The result of the dimensional factorization and normalization for the Nernst–Planck weak form after choosing the reference factor from the diffusion term is shown in Fig. 18. The dimensionless groups appearing in Fig. 18 include the 

Expression Dref c2

> ref

/l ref 

Value (base units) 2500 .0 mol 2/(m 5s) 

> (a) Reference factor from “diffusion”

Term Factor Value 

diffusion 1 1convection F φ ref /(RT ) 38.68 debye_0th F 2√cref e0/(RT ϵ 0)3/2 3213 debye_1st F 3cref e0lref /(RT ϵ 0)2 1475 

> (b) Normalized terms

Figure 18: Automated dimensional factorization and normalization for the Nernst–Planck equation weak form in the Poisson–Nernst–Planck system. Each term is expressed with respect to the reference factor from the diffusion term, resulting in dimensionless coefficients. This output was generated by the dimensional analysis framework presented in this work. first group Π1 in the convection term, reflecting the ratio of thermal voltage to reference voltage. The Debye terms involve more complex combinations of the dimensional quantities, indicating their sensitivity to the ionic strength and ion size effects. From the results in Figs. 17 and 18, we observe that the most dominant contribution in the Nernst-Planck weak form arises from the zeroth-order Debye term, followed by the first-order Debye term. We also note that with the Taylor expansion, the Debye terms remain significantly larger than the diffusion and convection terms, suggesting that ion-ion interactions play a crucial role in the transport dynamics within this example system. Moreover, the first-order Debye term is still large compared to the diffusion term, indicating that even more terms in the expansion may be necessary for an accurate representation of the activity coefficient effects. 23 Automated dimensional analysis for PDEs PREPRINT 

We include the final dimensionless form of the coupled Poisson–Nernst–Planck system in Appendix D. Let us emphasize that with the dimensional analysis framework developed here, the final dimensionless form is automatically derived and hidden from the user. 

# 5 Conclusion 

This work establishes a rigorous framework for integrating dimensional analysis into the Unified Form Language (UFL). We achieve this through symbolic quantity tracking and graph-based homogeneous factorization. The implementation leverages the interoperability between UFL and SymPy. We introduced a Quantity class to associate physical units with UFL constants. We exploit the algebraic structure of physical dimensions. Since they form an abelian group, we represent them as vectors in Q7 within the SI system. This representation simplifies the implementation and enhances performance. The core functionality relies on the visitor pattern to traverse the UFL expression graph (DAG). This approach allows us to inspect and modify the computational graph directly. Consequently, the software injects scaling factors and performs factorization automatically, without requiring changes to the user’s high-level mathematical syntax. We demonstrated that automated nondimensionalization acts as a physics-aware diagonal preconditioner. This process algebraically equilibrates the resulting linear systems. Crucially, this method constitutes Full Operator Preconditioning (FOP). Scaling factors are applied directly to the variational form prior to assembly. This preserves floating-point significance that is otherwise lost in standard algebraic preconditioning. Analysis of the incompressible Navier–Stokes equations confirmed the role of reference scales. We showed that the condition number of the saddle-point matrix is explicitly controlled by dimensionless groups, such as the Euler number. Furthermore, we applied the framework to the Neo–Hooke hyperelasticity model. It successfully identified factor inconsistency in small deformation gradients ( uref /l ref ≪ 1) as an a priori indicator of catastrophic cancellation. Consequently, the dolfiny.units module provides a necessary mechanism to enforce dimensional consistency and optimize numerical stability at the formulation level. In the Poisson–Nernst–Planck multiphysics system, we demonstrated the framework’s capability to handle complex coupled equations. The automated dimensional analysis identified dimensionless groups that characterize the interplay between thermal, electric, and concentration effects. The current implementation has a few limitations. Handling of vector and tensor quantities with associated units is limited. Tensor-valued nodes are allowed, but they must have consistent units across all components. Future work could extend support for tensors with different units in different components. Additionally, not all UFL operators are natively supported. Nevertheless, it is easy for users to extend the implementation by adding new visitor methods for unsupported operators. Overall, we believe that the concepts presented in this work are useful regardless of the specific implementation in UFL. The ability to automatically check for dimensional consistency, identify dimensionless groups, and nondimensionalize variational forms is a powerful tool for scientific computing. It helps to prevent modeling errors, improve numerical stability, and gain insights into the physical system under investigation. We hope that similar capabilities will be integrated into other scientific computing frameworks in the future. 24 Automated dimensional analysis for PDEs PREPRINT 

# References 

Alnæs, Martin S. et al. (Feb. 2014). “Unified form language: A domain-specific language for weak formulations of partial differential equations”. In: ACM Transactions on Mathematical Software 40.2, pp. 1–37. ISSN : 1557-7295. 

> DOI

: 10.1145/2566630 . URL : http://dx.doi.org/10.1145/2566630 .Astropy Collaboration, Thomas P. Robitaille, Erik J. Tollerud, et al. (2013). “Astropy: A community Python package for astronomy”. In: Astronomy & Astrophysics 558, A33. DOI : 10.1051/0004-6361/201322068 .Baratta, Igor A. et al. (2023). DOLFINx: The next generation FEniCS problem solving environment . en. DOI : 10.5281/ ZENODO.10447666 . URL : https://zenodo.org/doi/10.5281/zenodo.10447666 .Benzi, Michele, Gene H. Golub, and Jörg Liesen (Apr. 2005). “Numerical solution of saddle point problems”. In: Acta Numerica 14, pp. 1–137. ISSN : 1474-0508. DOI : 10.1017/s0962492904000212 . URL : http://dx.doi.org/10. 1017/S0962492904000212 .Buckingham, Edgar (1914). “On Physically Similar Systems; Illustrations of the Use of Dimensional Equations”. In: 

Physical Review 4.4, pp. 345–376. DOI : 10.1103/PhysRev.4.345 .Cranmer, Miles et al. (2023). DynamicQuantities.jl . URL : https : / / github . com / JuliaPhysics / DynamicQuantities.jl .Dale, Darren (2009). GitHub - python-quantities/python-quantities: Quantities package for the python programming language — github.com . https://github.com/python-quantities/python-quantities .Davies, Kevin (2013). GitHub - kdavies4/natu: Natural units in Python — github.com . https://github.com/ kdavies4/natu .Farrell, Patrick E., Robert C. Kirby, and Jorge Marchena-Menendez (2020). “Irksome: Automating Runge–Kutta time-stepping for finite element methods”. In: DOI : 10.48550/ARXIV.2006.16282 . URL : https://arxiv.org/ abs/2006.16282 .Golub, Gene H. and Charles F. Van Loan (2013). Matrix Computations - 4th Edition . Philadelphia, PA: Johns Hopkins University Press. DOI : 10.1137/1.9781421407944 . eprint: https://epubs.siam.org/doi/pdf/10.1137/1. 9781421407944 . URL : https://epubs.siam.org/doi/abs/10.1137/1.9781421407944 .Grecco, Hernan E. et al. (2023). Pint: Operate and manipulate physical quantities in Python . Version 0.20.1. URL :

https://github.com/hgrecco/pint .Habera, Michal, Paul T. Kühner, and Andreas Zilian (2025). dolfiny: High-level and convenience wrappers for DOLFINx .

https://github.com/fenics-dolfiny/dolfiny .Ham, David A. et al. (May 2023). Firedrake User Manual . First edition. Imperial College London et al. DOI : 10. 25561/104839 .Herrmann, Leonard R. (Oct. 1965). “Elasticity equations for incompressible and nearly incompressible materials by a variational theorem.” In: AIAA Journal 3.10, pp. 1896–1900. ISSN : 1533-385X. DOI : 10.2514/3.3277 . URL :

http://dx.doi.org/10.2514/3.3277 .International Organization for Standardization (2022). Quantities and units – Part 1: General . https://www.iso. org/standard/76921.html . Standard ISO 80000-1:2022. Keller, Mosè et al. (2022). Unitful.jl: Physical units in Julia . URL : https://github.com/PainterQubits/Unitful. jl .Langtangen, H.P. and G.K. Pedersen (2016). Scaling of Differential Equations . Simula SpringerBriefs on Computing. Springer International Publishing. ISBN : 9783319327266. URL : https : / / books . google . de / books ? id = JtlCDwAAQBAJ .Mars Climate Orbiter Mishap Investigation Board (Nov. 1999). Phase I Report . Tech. rep. Mars Climate Orbiter Mishap Investigation Board Report. National Aeronautics and Space Administration. URL : https://llis.nasa.gov/ llis_lib/pdf/1009464main1_0641-mr.pdf .Mdipierro (2016). GitHub - mdipierro/buckingham: A library for error propagation and metric conversions — github.com . https://github.com/mdipierro/buckingham .Meurer, Aaron, Christopher P. Smith, Mateusz Paprocki, et al. (2017). “SymPy: symbolic computing in Python”. In: 

PeerJ Computer Science 3, e103. DOI : 10.7717/peerj-cs.103 .Mohr, Stephan, Yuji Nakatsukasa, and Carolina Urzúa-Torres (Jan. 2024). “Full operator preconditioning and the accuracy of solving linear systems”. In: IMA Journal of Numerical Analysis 44.6, pp. 3259–3279. ISSN : 1464-3642. 

> DOI

: 10.1093/imanum/drad104 . URL : http://dx.doi.org/10.1093/imanum/drad104 .Pence, Thomas J and Kun Gou (Aug. 2014). “On compressible versions of the incompressible neo-Hookean material”. In: Mathematics and Mechanics of Solids 20.2, pp. 157–182. ISSN : 1741-3028. DOI : 10.1177/1081286514544258 .

> URL

: http://dx.doi.org/10.1177/1081286514544258 .Pusz, Mateusz (2019). A C++ Approach to Physical Units . ISO/IEC JTC1/SC22/WG21 P1935R0. URL : https : //mpusz.github.io/wg21-papers/papers/1935R0_a_cpp_approach_to_physical_units.html .Reyero, Juan (2006). GitHub - juanre/magnitude: A Python library for computing with numbers with units. — github.com .

https://github.com/juanre/magnitude .25 Automated dimensional analysis for PDEs PREPRINT 

Samson, E. and J. Marchand (July 1999). “Numerical Solution of the Extended Nernst–Planck Model”. In: Journal of Colloid and Interface Science 215.1, pp. 1–8. ISSN : 0021-9797. DOI : 10 . 1006 / jcis . 1999 . 6145 . URL :

http://dx.doi.org/10.1006/jcis.1999.6145 .Sander, Oliver (Dec. 2020). DUNE — the distributed and unified numerics environment . en. 2020th ed. Lecture notes in computational science and engineering. Cham, Switzerland: Springer Nature. Schabel, Matthias C. and Steven Watanabe (2008). “Boost.Units: Zero-Overhead Dimensional Analysis and Unit/Quantity Manipulation and Conversion”. In: Boost C++ Libraries . URL : https : / / www . boost . org / doc/libs/1_82_0/doc/html/boost_units.html .Shakeri, Rezgar et al. (July 2024). “Stable numerics for finite-strain elasticity”. In: International Journal for Numerical Methods in Engineering . ISSN : 1097-0207. DOI : 10.1002/nme.7563 . URL : http://dx.doi.org/10.1002/nme. 7563 .Sluis, A. van der (Dec. 1969). “Condition numbers and equilibration of matrices”. In: Numerische Mathematik 14.1, pp. 14–23. ISSN : 0945-3245. DOI : 10.1007/bf02165096 . URL : http://dx.doi.org/10.1007/BF02165096 .Tao, Terence (Dec. 2012). A mathematical formalisation of dimensional analysis . What’s new (WordPress). https: / / terrytao . wordpress . com / 2012 / 12 / 29 / a - mathematical - formalisation - of - dimensional -analysis/ .Zilian, Andreas and Michal Habera (2021). dolfiny: Convenience wrappers for DOLFINx . DOI : 10 . 6084 / M9 . FIGSHARE.14495262 . URL : https://figshare.com/articles/conference_contribution/dolfiny_ Convenience_wrappers_for_DOLFINx/14495262 .

# A Estimate of the condition number for the Navier–Stokes system 

Following is a standard result from the theory of saddle-point systems, see Benzi, Golub, and Liesen (2005, §3.5). First, we show that the smallest singular value of the matrix K defined in Eq. (42) approaches zero, σ1 → 0, as Eu → 0.Consider 

|det K| = det A det  −Eu 2BA −1BT = Eu 2m det A det  BA −1BT = Eu 2mC0, (69) which follows from the determinant expansion of the Schur factorization of K, i.e. 

K =

 I 0Eu BA −1 I

  A 00 −Eu 2BA −1BT

  I Eu A−1BT

0 I



(70) and C0 is a constant independent of Eu . The largest singular value is bounded below. We have σN ≥ ∥ A∥. We use the ordering of singular values σ1 ≤ σ2 ≤ . . . ≤ σN , thus 

σN 

> 1

≤ σ1σ2 . . . σ N = |det K| (71) and consequently 

σ1 ≤ | det K|1/N = Eu 2m/N C1/N  

> 0

. (72) Combining the upper bound for σ1 with the lower bound for σN leads to 

κ2(K) = σN

σ1

≥ ∥A∥

C1/N  

> 0

Eu 2m/N = C1Eu −2m/N , (73) for some constant C1 > 0 independent of Eu .

# B Expansion of Neo–Hooke strain energy density 

To resolve the factorization inconsistency without imposing artificial constraints on the reference scales, we abandon the formulation based directly on the deformation gradient F and switch to the Green-Lagrange strain tensor E.While F describes the deformation relative to the current configuration (scaling as I + O(Π 3)), the Green-Lagrange strain operates on the displacement deviation directly, allowing the identity term to be eliminated from the kinematic description. The Green-Lagrange strain is defined as 

E = 12 (C − I) = 12 (FT F − I). (74) 26 Automated dimensional analysis for PDEs PREPRINT 

Substituting the definition F = I + ∇u, the strain tensor naturally splits into linear and nonlinear contributions 

E = 12 (∇u + ∇uT )

| {z }

> linear part

+ 12 ∇uT ∇u

| {z }

> nonlinear part

= E1+ E2.

(75) Consequently, the strain energy density ˜W must be reformulated as a function of E rather than C. We utilize the identities relating the invariants of C to E

I1(C) = tr( I + 2 E) = 3 + 2tr( E), (76) 

J(C) = pdet( I + 2 E). (77) Substituting these into the original Neo-Hookean energy density expression yields 

˜W (E) = μ

2 ((3 + 2tr( E)) − 3 − 2 ln( J(E))) + κ

2 (J(E) − 1) 2

= μ (tr( E) − ln( J(E))) 

| {z } 

> isochoric term ˜Wμ

+ κ

2 (J(E) − 1) 2

| {z } 

> volumetric term ˜Wκ

. (78) Under transformation u 7 → uref u and ∇ 7 → (1 /l ref )∇, the Green-Lagrange strain transforms as 

E = E1 + E2 7 → Π3E1 + Π 23E2. (79) We expand the strain energy density ˜W (Π 3E1 + Π 23E2) in terms of Π3 around Π3 = 0 . First, we use the determinant expansion 

det( I + 2 E) = 1 + 2 tr( E) + 2 tr( E)2 − 2 tr  E2 + O(∥E∥3). (80) Since the square root √1 + x = 1 + x/ 2 − x2/8 + O(x3), we have 

J(E) = 1 + 



tr( E) + tr( E)2 − tr  E2| {z }

> x/ 2

− 12 tr( E)2

| {z }

> x2/8≈(2 tr( E)) 2/8

+O(∥E∥3), (81) where we have only kept the term 2 tr( E) in the x2/8 contribution, since the other terms are of higher order in ∥E∥.This can be regrouped as 

J(E) = 1 + tr( E) + 12 tr( E)2 − tr  E2 + O(∥E∥3). (82) For the term ln( J(E)) , we use that ln(1 + y) = y − y2/2 + O(y3), leading to 

ln( J(E)) = tr( E) − tr  E2 + 43 tr  E3 + O(∥E∥4), (83) which we can insert into the isochoric part of the strain energy density 

˜Wμ(E) = μ (tr( E) − ln( J(E))) = μ



tr  E2 − 43 tr  E3

+ O(∥E∥4). (84) Using the expansion of the Green-Lagrange strain in terms of Π3, we have 

˜Wμ = μ



Π23 tr  E21

 + Π 33



2 tr( E1E2) − 43 tr  E31

 

+ O(Π 43). (85) The volumetric part ˜Wκ uses 

(J(E) − 1) 2 = tr( E)2 + tr( E)3 − 2 tr( E) tr  E2 + O(∥E∥4), (86) which gives 

˜Wκ = κ

2



Π23 tr( E1)2 + Π 33



2 tr( E1) tr( E2) + tr( E1)3 − 2 tr( E1) tr  E21

 

. (87) Overall, the Neo-Hookean strain energy density expanded up to third order in Π3 reads 

˜W = ˜W (2) + ˜W (3) + O(Π 43),

˜W (2) = Π 23

 μ tr  E21

 + κ

2 tr( E1)2

| {z } 

> 12Slin :E1

,

˜W (3) = Π 33

 (2 μE1 + κ tr( E1)I) : E2

| {z }

> Slin :E2

+κ

 12 tr( E1)3 − tr( E1) tr  E21



− 4μ

3 tr  E31

 .

(88) 27 Automated dimensional analysis for PDEs PREPRINT 

# C The dimensionless form of the Neo–Hooke hyperelasticity 

Dimensionless form of the compressible Neo–Hooke hyperelasticity based on the expansion around Π3 = uref /l ref = 0 

developed in Appendix B and the automated nondimensionalization framework developed in this work is given by: find 

u ∈ U0 which solves 

min 

> u∈U0

W (u) − Wext (u) (89) where the dimensionless internal strain energy is taken as 

W (u) = μκ

Z

> Ω

tr  E21

 dx (shear 2nd order) 

+ 12

Z

> Ω

tr( E1)2 dx (bulk 2nd order) 

+ μκuref 

lref 

Z

> Ω



2E1 : E2 − 43 tr  E31



dx (shear 3rd order) 

+ uref 

lref 

Z

> Ω



tr( E1) tr( E2) − 12 tr( E1)3



dx (bulk 3rd order) (90) and the dimensionless external work for a traction force t applied on the Neumann boundary ΓN is 

Wext (u) = lref 

uref 

τref 

κ

Z

> ΓN

t · u ds. (91) In the above formulation, the only dimensional quantities are the shear modulus μ, the bulk modulus κ, the reference displacement uref , the reference length lref , and the reference traction τref . All other quantities are dimensionless. There are three dimensionless groups present in the formulation: the ratio of shear to bulk modulus μ/κ , the ratio of reference displacement to reference length uref /l ref , and the ratio of reference traction to bulk modulus τref /κ .

# D The dimensionless form of the Poisson–Nernst–Planck equations 

Dimensionless form of the steady-state Poisson–Nernst–Planck equations based on the automated nondimensionalization framework developed in this work is given by: for N species, find their concentrations ci ∈ W0, i = 1 , . . . , N and the electric potential φ ∈ V0 which solve the coupled Poisson equation 

Z

> Ω

ϵr ∇φ · ∇ δφ dx (potential) 

− F c ref l2

> ref

ϵ0φref 

Z

> Ω
> N

X

> i=1

zici + w

!

δφ dx (electroneutrality) 

= 0 ∀δφ ∈ V0,

(92) and the steady-state Nernst–Planck equations for each species i = 1 , . . . , N 

Z

> Ω

∇ci · ∇ δc i dx (diffusion) 

+ F φ ref 

RT 

Z

> Ω

zici∇φ · ∇ δc i dx (convection) 

+ F 2e0

√cref 

(RT ϵ 0)3/2

Z

> Ω

ci∇β(0)  

> i

· ∇ δc i dx (0th order Debye) 

+ F 3e0lref cref 

(RT ϵ 0)2

Z

> Ω

ci∇β(1)  

> i

· ∇ δc i dx (1st order Debye) 

= 0 ∀δc i ∈ W0,

(93) where we use the symbols β(0)  

> i

and β(1)  

> i

to denote the 0th and 1st order Debye terms from the Taylor expansion of the activity coefficient ln( γi) defined as 

β(0)  

> i

= −√28πϵ 3/2

> r

z2

> i

√I, β(1)  

> i

=

√28πϵ 3/2

> r

√2

√ϵr

aiz2 

> i

I. 

(94) 28 Automated dimensional analysis for PDEs PREPRINT 

In the above formulation, the only dimensional quantities are the reference concentration cref , the reference potential 

φref , the reference length lref , the absolute temperature T , the ionic radii ai, the Faraday constant F , the universal gas constant R, the vacuum permittivity ϵ0, and the elementary charge e0. All other quantities are dimensionless. The reference diffusion coefficient Dref is not present in the dimensionless formulation, as it cancels out in the steady-state equations. 29